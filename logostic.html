<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS Application - Logistics & Production</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/primeicons/6.0.1/primeicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/primeng/16.0.2/resources/themes/lara-light-blue/theme.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/primeng/16.0.2/resources/primeng.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .pos-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .sidebar-header {
            padding: 20px;
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            text-align: center;
        }

        .sidebar-header h2 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .nav-menu {
            padding: 20px 0;
        }

        .nav-item {
            padding: 12px 20px;
            margin: 2px 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #333;
        }

        .nav-item:hover {
            background: rgba(33, 150, 243, 0.1);
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .nav-item i {
            font-size: 1.2rem;
            min-width: 20px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .content-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .content-header h1 {
            color: #333;
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .content-header p {
            color: #666;
            font-size: 1.1rem;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-title {
            font-size: 1.4rem;
            color: #333;
            font-weight: 600;
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            font-weight: 600;
            color: #333;
        }

        .data-table tr:hover {
            background: rgba(33, 150, 243, 0.05);
        }

        /* Status badges */
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .status-pending { background: #fff3cd; color: #856404; }
        .status-inproduction { background: #cce5ff; color: #004085; }
        .status-dispatched { background: #d1ecf1; color: #0c5460; }
        .status-delivered { background: #d4edda; color: #155724; }
        .status-cancelled { background: #f8d7da; color: #721c24; }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(33, 150, 243, 0.3);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(33, 150, 243, 0.4);
        }

        .stat-card.green {
            background: linear-gradient(135deg, #4CAF50, #388E3C);
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.3);
        }

        .stat-card.orange {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            box-shadow: 0 4px 20px rgba(255, 152, 0, 0.3);
        }

        .stat-card.red {
            background: linear-gradient(135deg, #F44336, #D32F2F);
            box-shadow: 0 4px 20px rgba(244, 67, 54, 0.3);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #1976D2, #1565C0);
            transform: translateY(-2px);
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50, #388E3C);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #F44336, #D32F2F);
            color: white;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
                overflow: hidden;
            }

            .sidebar:hover {
                width: 280px;
            }

            .nav-item span {
                opacity: 0;
                transition: opacity 0.3s ease;
            }

            .sidebar:hover .nav-item span {
                opacity: 1;
            }
        }

        .hidden {
            display: none;
        }

        /* Chart container */
        .chart-container {
            height: 300px;
            margin: 20px 0;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-overlay.hidden {
            display: none !important;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .inventory-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
        }

        .inventory-item h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .inventory-details {
            font-size: 0.9rem;
            color: #666;
        }

        .low-stock {
            border-left-color: #F44336;
            background: #ffebee;
        }

        /* Login Screen Styles */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }

        .login-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #2196F3, #1976D2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .login-header p {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 0;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group-login {
            position: relative;
        }

        .form-group-login label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input-login {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            box-sizing: border-box;
        }

        .form-input-login:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 4px rgba(33, 150, 243, 0.1);
            background: white;
        }

        .login-btn {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
        }

        .login-btn:hover {
            background: linear-gradient(135deg, #1976D2, #1565C0);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(33, 150, 243, 0.3);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .login-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e1e5e9;
        }

        .login-footer p {
            color: #666;
            font-size: 0.9rem;
            margin: 0;
        }

        .login-footer a {
            color: #2196F3;
            text-decoration: none;
            font-weight: 600;
        }

        .login-footer a:hover {
            text-decoration: underline;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #f44336;
            font-size: 0.9rem;
        }

        .success-message {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #4caf50;
            font-size: 0.9rem;
        }

        .floating-shapes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .shape:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .shape:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 60%;
            right: 10%;
            animation-delay: 2s;
        }

        .shape:nth-child(3) {
            width: 60px;
            height: 60px;
            top: 80%;
            left: 20%;
            animation-delay: 4s;
        }

        .shape:nth-child(4) {
            width: 100px;
            height: 100px;
            top: 10%;
            right: 20%;
            animation-delay: 1s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            50% {
                transform: translateY(-20px) rotate(180deg);
            }
        }

        /* Hide main app initially */
        .pos-container {
            display: none;
        }

        .pos-container.show {
            display: flex;
        }

        /* Responsive login */
        @media (max-width: 480px) {
            .login-card {
                margin: 20px;
                padding: 30px 25px;
            }
            
            .login-header h1 {
                font-size: 2rem;
            }
        }
    </style>
    
    
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="floating-shapes">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>
        <div class="login-card">
            <div class="login-header">
                <h1>POS System</h1>
                <p>Logistics & Production Management</p>
            </div>
            <form class="login-form" onsubmit="handleLogin(event)">
                <div id="errorMessage" class="error-message hidden"></div>
                <div id="successMessage" class="success-message hidden"></div>
                
                <div class="form-group-login">
                    <label for="username">Username</label>
                    <input type="text" id="username" class="form-input-login" placeholder="Enter your username" required>
                </div>
                
                <div class="form-group-login">
                    <label for="password">Password</label>
                    <input type="password" id="password" class="form-input-login" placeholder="Enter your password" required>
                </div>
                
                <button type="submit" class="login-btn">
                    Sign In
                </button>
            </form>
            
            <div class="login-footer">
                <p>Demo Credentials: <strong>admin</strong> / <strong>password123</strong></p>
                <p>Need help? <a href="#" onclick="showForgotPassword()">Forgot Password?</a></p>
            </div>
        </div>
    </div>

    <!-- Main POS Application -->
    <div id="mainApp" class="pos-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>POS System</h2>
                <p>Logistics & Production</p>
                <button class="btn btn-danger" onclick="logout()" style="margin-top: 10px; padding: 8px 16px; font-size: 0.8rem;">
                    <i class="pi pi-sign-out"></i> Logout
                </button>
            </div>
            <nav class="nav-menu">
                <div class="nav-item active" onclick="showSection('dashboard', event)">
                    <i class="pi pi-home"></i>
                    <span>Dashboard</span>
                </div>
                <div class="nav-item" onclick="showSection('orders', event)">
                    <i class="pi pi-shopping-cart"></i>
                    <span>Order Management</span>
                </div>
                <div class="nav-item" onclick="showSection('inventory', event)">
                    <i class="pi pi-box"></i>
                    <span>Inventory</span>
                </div>
                <div class="nav-item" onclick="showSection('staff', event)">
                    <i class="pi pi-users"></i>
                    <span>Staff Management</span>
                </div>
                <div class="nav-item" onclick="showSection('accounting', event)">
                    <i class="pi pi-calculator"></i>
                    <span>Accounting</span>
                </div>
                <div class="nav-item" onclick="showSection('crm', event)">
                    <i class="pi pi-user"></i>
                    <span>CRM</span>
                </div>
                <div class="nav-item" onclick="showSection('suppliers', event)">
                    <i class="pi pi-building"></i>
                    <span>Suppliers</span>
                </div>
                <div class="nav-item" onclick="showSection('production', event)">
                    <i class="pi pi-cog"></i>
                    <span>Production</span>
                </div>
                <div class="nav-item" onclick="showSection('logistics', event)">
                    <i class="pi pi-truck"></i>
                    <span>Logistics</span>
                </div>
                <div class="nav-item" onclick="showSection('reports', event)">
                    <i class="pi pi-chart-bar"></i>
                    <span>Reports</span>
                </div>
            </nav>
        </div>

        <div class="main-content">
            <div id="dashboard" class="content-section">
                <div class="content-header">
                    <h1>Dashboard</h1>
                    <p>Welcome to your POS management system overview</p>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number">1,247</div>
                        <div class="stat-label">Total Orders</div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-number">₹5,67,890</div>
                        <div class="stat-label">Revenue Today</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number">156</div>
                        <div class="stat-label">Pending Orders</div>
                    </div>
                    <div class="stat-card red">
                        <div class="stat-number">23</div>
                        <div class="stat-label">Low Stock Items</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Recent Orders</h3>
                        <button class="btn btn-primary" onclick="showSection('orders', event)">View All</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>#ORD-2024-001</td>
                                <td>ABC Distributors</td>
                                <td>₹25,400</td>
                                <td><span class="status-badge status-delivered">Delivered</span></td>
                                <td>2024-09-25</td>
                            </tr>
                            <tr>
                                <td>#ORD-2024-002</td>
                                <td>XYZ Retail</td>
                                <td>₹18,750</td>
                                <td><span class="status-badge status-dispatched">Dispatched</span></td>
                                <td>2024-09-25</td>
                            </tr>
                            <tr>
                                <td>#ORD-2024-003</td>
                                <td>Direct Customer</td>
                                <td>₹12,300</td>
                                <td><span class="status-badge status-inproduction">In Production</span></td>
                                <td>2024-09-24</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="orders" class="content-section hidden">
                <div class="content-header">
                    <h1>Order Management</h1>
                    <p>Manage customer orders, distributor orders, and production orders with workflow approval</p>
                </div>

                <!-- Order Filters -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Order Filters</h3>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select class="form-input" id="orderStatusFilter" onchange="filterOrders()" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="Pending">Pending</option>
                            <option value="Approved">Approved</option>
                            <option value="In Production">In Production</option>
                            <option value="Dispatched">Dispatched</option>
                            <option value="Delivered">Delivered</option>
                            <option value="Cancelled">Cancelled</option>
                            <option value="Returned">Returned</option>
                        </select>
                        <select class="form-input" id="orderTypeFilter" onchange="filterOrders()" style="width: 150px;">
                            <option value="">All Types</option>
                            <option value="Customer">Customer</option>
                            <option value="Distributor">Distributor</option>
                            <option value="Internal">Internal</option>
                            <option value="Production">Production</option>
                        </select>
                        <input type="date" class="form-input" id="orderDateFilter" onchange="filterOrders()" style="width: 150px;">
                        <button class="btn btn-primary" onclick="showModal('newOrderModal')">New Order</button>
                        <button class="btn btn-success" onclick="showModal('returnRefundModal')">Process Return</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">All Orders</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="exportOrders()">Export</button>
                            <button class="btn btn-success" onclick="bulkApproveOrders()">Bulk Approve</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAllOrders" onchange="toggleAllOrders()"></th>
                                <th>Order ID</th>
                                <th>Type</th>
                                <th>Customer/Distributor</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Priority</th>
                                <th>Date</th>
                                <th>Delivery Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Order Workflow Status -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Order Workflow Status</h3>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="pendingApprovalCount">0</div>
                            <div class="stat-label">Pending Approval</div>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-number" id="inProductionCount">0</div>
                            <div class="stat-label">In Production</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="dispatchedCount">0</div>
                            <div class="stat-label">Dispatched</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number" id="deliveredCount">0</div>
                            <div class="stat-label">Delivered</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="inventory" class="content-section hidden">
                <div class="content-header">
                    <h1>Stock & Inventory Management</h1>
                    <p>Real-time stock tracking with barcode/QR integration and multi-warehouse management</p>
                </div>

                <!-- Inventory Filters -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Inventory Filters</h3>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select class="form-input" id="inventoryCategoryFilter" onchange="filterInventory()" style="width: 150px;">
                            <option value="">All Categories</option>
                            <option value="Raw Materials">Raw Materials</option>
                            <option value="Finished Goods">Finished Goods</option>
                            <option value="Packaging">Packaging Materials</option>
                        </select>
                        <select class="form-input" id="inventoryLocationFilter" onchange="filterInventory()" style="width: 150px;">
                            <option value="">All Locations</option>
                            <option value="Warehouse 1">Warehouse 1</option>
                            <option value="Warehouse 2">Warehouse 2</option>
                            <option value="Warehouse 3">Warehouse 3</option>
                            <option value="Production Floor">Production Floor</option>
                        </select>
                        <select class="form-input" id="inventoryStatusFilter" onchange="filterInventory()" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="low-stock">Low Stock</option>
                            <option value="out-of-stock">Out of Stock</option>
                            <option value="normal">Normal Stock</option>
                        </select>
                        <button class="btn btn-primary" onclick="showModal('addProductModal')">Add Product</button>
                        <button class="btn btn-success" onclick="showModal('barcodeScannerModal')">Scan Barcode</button>
                        <button class="btn btn-primary" onclick="showModal('stockAdjustmentModal')">Stock Adjustment</button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalProductsCount">2,458</div>
                        <div class="stat-label">Total Products</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number" id="lowStockCount">23</div>
                        <div class="stat-label">Low Stock</div>
                    </div>
                    <div class="stat-card red">
                        <div class="stat-number" id="outOfStockCount">5</div>
                        <div class="stat-label">Out of Stock</div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-number" id="totalInventoryValue">₹12,45,678</div>
                        <div class="stat-label">Total Inventory Value</div>
                    </div>
                </div>

                <!-- Multi-Warehouse Overview -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Multi-Warehouse Overview</h3>
                        <button class="btn btn-primary" onclick="showModal('addWarehouseModal')">Add Warehouse</button>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">1,245</div>
                            <div class="stat-label">Warehouse 1 Items</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">856</div>
                            <div class="stat-label">Warehouse 2 Items</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">357</div>
                            <div class="stat-label">Warehouse 3 Items</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">₹8,45,678</div>
                            <div class="stat-label">Total Value</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Inventory Overview</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="exportInventory()">Export</button>
                            <button class="btn btn-success" onclick="generateReorderReport()">Reorder Report</button>
                            <button class="btn btn-primary" onclick="showModal('batchTrackingModal')">Batch Tracking</button>
                        </div>
                    </div>
                    <div class="inventory-grid" id="inventoryGrid">
                        </div>
                </div>

                <!-- Reorder Alerts -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Reorder Alerts</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Current Stock</th>
                                <th>Min Stock Level</th>
                                <th>Reorder Quantity</th>
                                <th>Supplier</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reorderAlertsTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="staff" class="content-section hidden">
                <div class="content-header">
                    <h1>Staff Management</h1>
                    <p>Manage staff profiles, attendance, biometric check-in, and performance tracking</p>
                </div>

                <!-- Staff Filters -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Staff Filters</h3>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select class="form-input" id="staffDepartmentFilter" onchange="filterStaff()" style="width: 150px;">
                            <option value="">All Departments</option>
                            <option value="Production">Production</option>
                            <option value="Logistics">Logistics</option>
                            <option value="Sales">Sales</option>
                            <option value="Finance">Finance</option>
                        </select>
                        <select class="form-input" id="staffRoleFilter" onchange="filterStaff()" style="width: 150px;">
                            <option value="">All Roles</option>
                            <option value="Manager">Manager</option>
                            <option value="Supervisor">Supervisor</option>
                            <option value="Operator">Operator</option>
                            <option value="Clerk">Clerk</option>
                        </select>
                        <select class="form-input" id="staffStatusFilter" onchange="filterStaff()" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="Present">Present</option>
                            <option value="On Leave">On Leave</option>
                            <option value="Absent">Absent</option>
                        </select>
                        <button class="btn btn-primary" onclick="showModal('addStaffModal')">Add Staff</button>
                        <button class="btn btn-success" onclick="showModal('biometricCheckinModal')">Biometric Check-in</button>
                        <button class="btn btn-primary" onclick="showModal('shiftScheduleModal')">Shift Schedule</button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalStaffCount">45</div>
                        <div class="stat-label">Total Staff</div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-number" id="presentTodayCount">42</div>
                        <div class="stat-label">Present Today</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number" id="onLeaveCount">3</div>
                        <div class="stat-label">On Leave</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="attendanceRate">98%</div>
                        <div class="stat-label">Attendance Rate</div>
                    </div>
                </div>

                <!-- Shift Management -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Current Shift Schedule</h3>
                        <button class="btn btn-primary" onclick="showModal('addShiftModal')">Add Shift</button>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">15</div>
                            <div class="stat-label">Morning Shift (6AM-2PM)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">18</div>
                            <div class="stat-label">Afternoon Shift (2PM-10PM)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">12</div>
                            <div class="stat-label">Night Shift (10PM-6AM)</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">45</div>
                            <div class="stat-label">Total Scheduled</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Staff Overview</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="exportStaff()">Export</button>
                            <button class="btn btn-success" onclick="generatePayroll()">Generate Payroll</button>
                            <button class="btn btn-primary" onclick="showModal('performanceReportModal')">Performance Report</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Employee ID</th>
                                <th>Name</th>
                                <th>Role</th>
                                <th>Department</th>
                                <th>Shift</th>
                                <th>Status</th>
                                <th>Check-in Time</th>
                                <th>Productivity Score</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="staffTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Attendance Tracking -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Today's Attendance</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Check-in Time</th>
                                <th>Check-out Time</th>
                                <th>Hours Worked</th>
                                <th>Overtime</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Productivity Tracking -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Productivity Metrics</h3>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">95%</div>
                            <div class="stat-label">Avg. Productivity</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">28</div>
                            <div class="stat-label">Orders Completed</div>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-number">2.5</div>
                            <div class="stat-label">Avg. Hours/Order</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">₹45,000</div>
                            <div class="stat-label">Total Payroll</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="accounting" class="content-section hidden">
                <div class="content-header">
                    <h1>Accounting & Finance</h1>
                    <p>GST-compliant billing, payment gateway integration, multi-currency support, and tax management</p>
                </div>

                <!-- Financial Filters -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Financial Filters</h3>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select class="form-input" id="financialPeriodFilter" onchange="filterFinancials()" style="width: 150px;">
                            <option value="">All Periods</option>
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                            <option value="year">This Year</option>
                        </select>
                        <select class="form-input" id="transactionTypeFilter" onchange="filterFinancials()" style="width: 150px;">
                            <option value="">All Types</option>
                            <option value="Sale">Sales</option>
                            <option value="Purchase">Purchases</option>
                            <option value="Expense">Expenses</option>
                            <option value="Payment">Payments</option>
                        </select>
                        <select class="form-input" id="currencyFilter" onchange="filterFinancials()" style="width: 150px;">
                            <option value="">All Currencies</option>
                            <option value="INR">INR (₹)</option>
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (€)</option>
                        </select>
                        <button class="btn btn-primary" onclick="showModal('createInvoiceModal')">Create Invoice</button>
                        <button class="btn btn-success" onclick="showModal('paymentGatewayModal')">Process Payment</button>
                        <button class="btn btn-primary" onclick="showModal('taxReportModal')">Tax Report</button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card green">
                        <div class="stat-number" id="monthlyRevenue">₹45,67,890</div>
                        <div class="stat-label">Monthly Revenue</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="monthlyExpenses">₹12,34,567</div>
                        <div class="stat-label">Expenses</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number" id="pendingPayments">₹2,45,678</div>
                        <div class="stat-label">Pending Payments</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="netProfit">₹33,33,223</div>
                        <div class="stat-label">Net Profit</div>
                    </div>
                </div>

                <!-- GST & Tax Overview -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">GST & Tax Overview</h3>
                        <button class="btn btn-primary" onclick="showModal('gstSettingsModal')">GST Settings</button>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">₹4,56,789</div>
                            <div class="stat-label">CGST Collected</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">₹4,56,789</div>
                            <div class="stat-label">SGST Collected</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">₹2,34,567</div>
                            <div class="stat-label">IGST Collected</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">₹11,48,145</div>
                            <div class="stat-label">Total GST</div>
                        </div>
                    </div>
                </div>

                <!-- Multi-Currency Overview -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Multi-Currency Overview</h3>
                        <button class="btn btn-primary" onclick="showModal('currencySettingsModal')">Currency Settings</button>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">₹45,67,890</div>
                            <div class="stat-label">INR Revenue</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">$12,345</div>
                            <div class="stat-label">USD Revenue</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">€8,765</div>
                            <div class="stat-label">EUR Revenue</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">₹52,45,678</div>
                            <div class="stat-label">Total (INR)</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Financial Transactions</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="showModal('addTransactionModal')">Add Transaction</button>
                            <button class="btn btn-success" onclick="exportFinancials()">Export</button>
                            <button class="btn btn-primary" onclick="showModal('reconciliationModal')">Reconcile</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Transaction ID</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Amount</th>
                                <th>Currency</th>
                                <th>GST</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transactionTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Payment Gateway Status -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Payment Gateway Status</h3>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card green">
                            <div class="stat-number">98.5%</div>
                            <div class="stat-label">Success Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">₹12,34,567</div>
                            <div class="stat-label">Processed Today</div>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-number">23</div>
                            <div class="stat-label">Failed Transactions</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">₹45,678</div>
                            <div class="stat-label">Refunds</div>
                        </div>
                    </div>
                </div>

                <!-- Receivables & Payables -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Receivables & Payables</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>Accounts Receivable</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Customer</th>
                                        <th>Amount</th>
                                        <th>Due Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="receivablesTableBody">
                                    </tbody>
                            </table>
                        </div>
                        <div>
                            <h4>Accounts Payable</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Supplier</th>
                                        <th>Amount</th>
                                        <th>Due Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="payablesTableBody">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="crm" class="content-section hidden">
                <div class="content-header">
                    <h1>Customer Relationship Management</h1>
                    <p>Enhanced CRM with loyalty points system, customer profiles, reminders, and relationship tracking</p>
                </div>

                <!-- CRM Filters -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">CRM Filters</h3>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select class="form-input" id="customerSegmentFilter" onchange="filterCustomers()" style="width: 150px;">
                            <option value="">All Segments</option>
                            <option value="Premium">Premium</option>
                            <option value="Regular">Regular</option>
                            <option value="New">New</option>
                            <option value="Inactive">Inactive</option>
                        </select>
                        <select class="form-input" id="customerStatusFilter" onchange="filterCustomers()" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                            <option value="VIP">VIP</option>
                        </select>
                        <select class="form-input" id="loyaltyTierFilter" onchange="filterCustomers()" style="width: 150px;">
                            <option value="">All Tiers</option>
                            <option value="Gold">Gold (1000+)</option>
                            <option value="Silver">Silver (500-999)</option>
                            <option value="Bronze">Bronze (100-499)</option>
                            <option value="Basic">Basic (0-99)</option>
                        </select>
                        <button class="btn btn-primary" onclick="showModal('addCustomerModal')">Add Customer</button>
                        <button class="btn btn-success" onclick="showModal('loyaltyProgramModal')">Loyalty Program</button>
                        <button class="btn btn-primary" onclick="showModal('customerReminderModal')">Set Reminder</button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card green">
                        <div class="stat-number" id="totalCustomersCount">1,250</div>
                        <div class="stat-label">Total Customers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="customerRevenue">₹2,45,678</div>
                        <div class="stat-label">Customer Revenue</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number" id="satisfactionRate">85%</div>
                        <div class="stat-label">Satisfaction Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="newCustomersCount">45</div>
                        <div class="stat-label">New Customers</div>
                    </div>
                </div>

                <!-- Loyalty Program Overview -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Loyalty Program Overview</h3>
                        <button class="btn btn-primary" onclick="showModal('loyaltySettingsModal')">Loyalty Settings</button>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">125</div>
                            <div class="stat-label">Gold Members</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">340</div>
                            <div class="stat-label">Silver Members</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">520</div>
                            <div class="stat-label">Bronze Members</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">₹1,25,000</div>
                            <div class="stat-label">Points Redeemed</div>
                        </div>
                    </div>
                </div>

                <!-- Customer Segmentation -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Customer Segmentation</h3>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">15%</div>
                            <div class="stat-label">Premium Customers</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">35%</div>
                            <div class="stat-label">Regular Customers</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">25%</div>
                            <div class="stat-label">New Customers</div>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-number">25%</div>
                            <div class="stat-label">Inactive Customers</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Customer Overview</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="showModal('addCustomerModal')">Add Customer</button>
                            <button class="btn btn-success" onclick="exportCustomers()">Export</button>
                            <button class="btn btn-primary" onclick="showModal('customerAnalyticsModal')">Analytics</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Customer ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Segment</th>
                                <th>Loyalty Points</th>
                                <th>Tier</th>
                                <th>Last Order</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customerTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Customer Reminders -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Customer Reminders</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Customer</th>
                                <th>Reminder Type</th>
                                <th>Message</th>
                                <th>Due Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="remindersTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Customer Communication History -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Communication History</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Customer</th>
                                <th>Communication Type</th>
                                <th>Subject</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="communicationTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="suppliers" class="content-section hidden">
                <div class="content-header">
                    <h1>Supplier & Vendor Management</h1>
                    <p>Comprehensive supplier management with purchase orders, settlements, and vendor relationships</p>
                </div>

                <!-- Supplier Filters -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Supplier Filters</h3>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select class="form-input" id="supplierCategoryFilter" onchange="filterSuppliers()" style="width: 150px;">
                            <option value="">All Categories</option>
                            <option value="Raw Materials">Raw Materials</option>
                            <option value="Packaging">Packaging</option>
                            <option value="Equipment">Equipment</option>
                            <option value="Services">Services</option>
                        </select>
                        <select class="form-input" id="supplierStatusFilter" onchange="filterSuppliers()" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                            <option value="Preferred">Preferred</option>
                            <option value="Blacklisted">Blacklisted</option>
                        </select>
                        <select class="form-input" id="supplierRatingFilter" onchange="filterSuppliers()" style="width: 150px;">
                            <option value="">All Ratings</option>
                            <option value="5">5 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="2">2 Stars</option>
                            <option value="1">1 Star</option>
                        </select>
                        <button class="btn btn-primary" onclick="showModal('addSupplierModal')">Add Supplier</button>
                        <button class="btn btn-success" onclick="showModal('createPurchaseOrderModal')">Create PO</button>
                        <button class="btn btn-primary" onclick="showModal('supplierSettlementModal')">Settlement</button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card green">
                        <div class="stat-number" id="totalSuppliersCount">125</div>
                        <div class="stat-label">Total Suppliers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="activeSuppliersCount">98</div>
                        <div class="stat-label">Active Suppliers</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number" id="pendingPOsCount">23</div>
                        <div class="stat-label">Pending POs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalPurchaseValue">₹45,67,890</div>
                        <div class="stat-label">Total Purchase Value</div>
                    </div>
                </div>

                <!-- Supplier Performance Overview -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Supplier Performance Overview</h3>
                        <button class="btn btn-primary" onclick="showModal('supplierPerformanceModal')">Performance Report</button>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">4.2</div>
                            <div class="stat-label">Avg. Rating</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">95%</div>
                            <div class="stat-label">On-Time Delivery</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">98%</div>
                            <div class="stat-label">Quality Score</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">₹12,34,567</div>
                            <div class="stat-label">Savings This Month</div>
                        </div>
                    </div>
                </div>

                <!-- Purchase Orders Overview -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Purchase Orders Overview</h3>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">45</div>
                            <div class="stat-label">Total POs</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">32</div>
                            <div class="stat-label">Completed</div>
                        </div>
                        <div class="stat-card orange">
                            <div class="stat-number">8</div>
                            <div class="stat-label">Pending</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">5</div>
                            <div class="stat-label">Overdue</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Supplier Overview</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="showModal('addSupplierModal')">Add Supplier</button>
                            <button class="btn btn-success" onclick="exportSuppliers()">Export</button>
                            <button class="btn btn-primary" onclick="showModal('supplierAnalyticsModal')">Analytics</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Supplier ID</th>
                                <th>Company Name</th>
                                <th>Contact Person</th>
                                <th>Category</th>
                                <th>Rating</th>
                                <th>Status</th>
                                <th>Last Order</th>
                                <th>Total Value</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="supplierTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Purchase Orders -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Purchase Orders</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="showModal('createPurchaseOrderModal')">Create PO</button>
                            <button class="btn btn-success" onclick="exportPurchaseOrders()">Export</button>
                            <button class="btn btn-primary" onclick="showModal('poAnalyticsModal')">Analytics</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>PO Number</th>
                                <th>Supplier</th>
                                <th>Date</th>
                                <th>Items</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Expected Delivery</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="purchaseOrderTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Supplier Settlements -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Supplier Settlements</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Supplier</th>
                                <th>Invoice Number</th>
                                <th>Amount</th>
                                <th>Due Date</th>
                                <th>Status</th>
                                <th>Payment Method</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="settlementTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Supplier Contracts -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Supplier Contracts</h3>
                        <button class="btn btn-primary" onclick="showModal('addContractModal')">Add Contract</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Contract ID</th>
                                <th>Supplier</th>
                                <th>Type</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Value</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="contractTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="production" class="content-section hidden">
                <div class="content-header">
                    <h1>Production Management</h1>
                    <p>Comprehensive production management with BOM, scheduling, work order tracking, and detailed production flow</p>
                </div>

                <!-- Production Filters -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Production Filters</h3>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select class="form-input" id="productionStatusFilter" onchange="filterProduction()" style="width: 150px;">
                            <option value="">All Status</option>
                            <option value="Pending">Pending</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Completed">Completed</option>
                            <option value="On Hold">On Hold</option>
                            <option value="Cancelled">Cancelled</option>
                        </select>
                        <select class="form-input" id="productionPriorityFilter" onchange="filterProduction()" style="width: 150px;">
                            <option value="">All Priorities</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Urgent">Urgent</option>
                        </select>
                        <select class="form-input" id="productionLineFilter" onchange="filterProduction()" style="width: 150px;">
                            <option value="">All Lines</option>
                            <option value="Line A">Line A</option>
                            <option value="Line B">Line B</option>
                            <option value="Line C">Line C</option>
                        </select>
                        <button class="btn btn-primary" onclick="showModal('addProductionOrderModal')">Add Order</button>
                        <button class="btn btn-success" onclick="showModal('createBOMModal')">Create BOM</button>
                        <button class="btn btn-primary" onclick="showModal('productionScheduleModal')">Schedule</button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card green">
                        <div class="stat-number" id="activeOrdersCount">45</div>
                        <div class="stat-label">Active Orders</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="productionEfficiency">78%</div>
                        <div class="stat-label">Efficiency</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number" id="pendingOrdersCount">12</div>
                        <div class="stat-label">Pending</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="productionValue">₹2,45,678</div>
                        <div class="stat-label">Production Value</div>
                    </div>
                </div>

                <!-- Production Lines Overview -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Production Lines Overview</h3>
                        <button class="btn btn-primary" onclick="showModal('productionLineModal')">Manage Lines</button>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">85%</div>
                            <div class="stat-label">Line A Utilization</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">92%</div>
                            <div class="stat-label">Line B Utilization</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">78%</div>
                            <div class="stat-label">Line C Utilization</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">85%</div>
                            <div class="stat-label">Overall Efficiency</div>
                        </div>
                    </div>
                </div>

                <!-- BOM Management -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Bill of Materials (BOM)</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="showModal('createBOMModal')">Create BOM</button>
                            <button class="btn btn-success" onclick="exportBOM()">Export</button>
                            <button class="btn btn-primary" onclick="showModal('bomAnalyticsModal')">Analytics</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>BOM ID</th>
                                <th>Product</th>
                                <th>Version</th>
                                <th>Components</th>
                                <th>Total Cost</th>
                                <th>Status</th>
                                <th>Created Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="bomTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Work Orders -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Work Orders</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="showModal('addWorkOrderModal')">Add Work Order</button>
                            <button class="btn btn-success" onclick="exportWorkOrders()">Export</button>
                            <button class="btn btn-primary" onclick="showModal('workOrderAnalyticsModal')">Analytics</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Work Order ID</th>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Production Line</th>
                                <th>Status</th>
                                <th>Priority</th>
                                <th>Start Date</th>
                                <th>Expected Completion</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="workOrderTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Production Schedule -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Production Schedule</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="showModal('productionScheduleModal')">Schedule</button>
                            <button class="btn btn-success" onclick="exportSchedule()">Export</button>
                            <button class="btn btn-primary" onclick="showModal('scheduleOptimizationModal')">Optimize</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Production Line</th>
                                <th>Work Order</th>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Start Time</th>
                                <th>End Time</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="scheduleTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Quality Control -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Quality Control</h3>
                        <button class="btn btn-primary" onclick="showModal('qualityCheckModal')">Quality Check</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>QC ID</th>
                                <th>Work Order</th>
                                <th>Product</th>
                                <th>Batch</th>
                                <th>Inspector</th>
                                <th>Result</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="qualityTableBody">
                            </tbody>
                    </table>
                </div>

                <!-- Production Analytics -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Production Analytics</h3>
                    </div>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number">95%</div>
                            <div class="stat-label">Quality Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">2.5%</div>
                            <div class="stat-label">Defect Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">₹1,25,000</div>
                            <div class="stat-label">Cost Savings</div>
                        </div>
                        <div class="stat-card green">
                            <div class="stat-number">98%</div>
                            <div class="stat-label">On-Time Delivery</div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="logistics" class="content-section hidden">
                <div class="content-header">
                    <h1>Logistics & Dispatch</h1>
                    <p>Vehicle allocation, route optimization, and delivery tracking</p>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number">25</div>
                        <div class="stat-label">Active Vehicles</div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-number">18</div>
                        <div class="stat-label">On Route</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-number">45</div>
                        <div class="stat-label">Pending Deliveries</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">92%</div>
                        <div class="stat-label">On-Time Delivery</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Delivery Schedule</h3>
                        <button class="btn btn-primary" onclick="showModal('scheduleDeliveryModal')">Schedule Delivery</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Delivery ID</th>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Vehicle</th>
                                <th>Driver</th>
                                <th>Status</th>
                                <th>ETA</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="logisticsTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="reports" class="content-section hidden">
                <div class="content-header">
                    <h1>Reports & Analytics</h1>
                    <p>Comprehensive business intelligence and analytics</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Sales Performance</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesChart" width="400" height="200"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Quick Reports</h3>
                    </div>
                    <div class="dashboard-grid">
                        <button class="btn btn-primary" onclick="generateReport('daily')">Daily Sales Report</button>
                        <button class="btn btn-primary" onclick="generateReport('monthly')">Monthly Report</button>
                        <button class="btn btn-primary" onclick="generateReport('inventory')">Inventory Report</button>
                        <button class="btn btn-primary" onclick="generateReport('profit')">Profit & Loss</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="newOrderModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3>Create New Order</h3>
                <button class="close-modal" onclick="hideModal('newOrderModal')">&times;</button>
            </div>
            <form onsubmit="createOrder(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Order Type</label>
                        <select class="form-input" id="orderType" required onchange="updateOrderFields()">
                            <option value="">Select Order Type</option>
                            <option value="Customer">Customer Order</option>
                            <option value="Distributor">Distributor Order</option>
                            <option value="Internal">Internal Order</option>
                            <option value="Production">Production Order</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Priority</label>
                        <select class="form-input" id="orderPriority" required>
                            <option value="Normal">Normal</option>
                            <option value="High">High</option>
                            <option value="Urgent">Urgent</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Customer/Distributor</label>
                    <select class="form-input" id="orderCustomer" required>
                        <option value="">Select Customer/Distributor</option>
                        <option value="ABC Distributors">ABC Distributors</option>
                        <option value="XYZ Retail">XYZ Retail</option>
                        <option value="Direct Customer">Direct Customer</option>
                        <option value="PQR Wholesale">PQR Wholesale</option>
                        <option value="LMN Stores">LMN Stores</option>
                    </select>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Product</label>
                        <select class="form-input" id="orderProduct" required onchange="updateProductPrice()">
                            <option value="">Select Product</option>
                            <option value="Product X" data-price="155.00">Product X</option>
                            <option value="Product Y" data-price="225.00">Product Y</option>
                            <option value="Product Z" data-price="180.00">Product Z</option>
                            <option value="Raw Material A" data-price="25.50">Raw Material A</option>
                            <option value="Raw Material B" data-price="45.75">Raw Material B</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Quantity</label>
                        <input type="number" class="form-input" id="orderQuantity" placeholder="Enter quantity" required onchange="calculateTotal()">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Unit Price</label>
                        <input type="number" step="0.01" class="form-input" id="orderUnitPrice" placeholder="Unit price" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Total Amount</label>
                        <input type="number" step="0.01" class="form-input" id="orderAmount" placeholder="Total amount" readonly>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Expected Delivery Date</label>
                        <input type="date" class="form-input" id="orderDeliveryDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Payment Terms</label>
                        <select class="form-input" id="orderPaymentTerms" required>
                            <option value="COD">Cash on Delivery</option>
                            <option value="Net15">Net 15 Days</option>
                            <option value="Net30">Net 30 Days</option>
                            <option value="Advance">Advance Payment</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Special Instructions</label>
                    <textarea class="form-input" id="orderInstructions" placeholder="Any special instructions or notes" rows="3"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('newOrderModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Order</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Return/Refund Modal -->
    <div id="returnRefundModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Process Return/Refund</h3>
                <button class="close-modal" onclick="hideModal('returnRefundModal')">&times;</button>
            </div>
            <form onsubmit="processReturnRefund(event)">
                <div class="form-group">
                    <label class="form-label">Order ID</label>
                    <select class="form-input" id="returnOrderId" required onchange="loadOrderDetails()">
                        <option value="">Select Order</option>
                        <option value="ORD-2024-001">ORD-2024-001</option>
                        <option value="ORD-2024-002">ORD-2024-002</option>
                        <option value="ORD-2024-003">ORD-2024-003</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Return Type</label>
                    <select class="form-input" id="returnType" required>
                        <option value="">Select Return Type</option>
                        <option value="Defective">Defective Product</option>
                        <option value="Wrong Item">Wrong Item Delivered</option>
                        <option value="Customer Request">Customer Request</option>
                        <option value="Damaged">Damaged in Transit</option>
                    </select>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Return Quantity</label>
                        <input type="number" class="form-input" id="returnQuantity" placeholder="Enter quantity" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Refund Amount</label>
                        <input type="number" step="0.01" class="form-input" id="refundAmount" placeholder="Refund amount" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Reason for Return</label>
                    <textarea class="form-input" id="returnReason" placeholder="Detailed reason for return" rows="3" required></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('returnRefundModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Process Return</button>
                </div>
            </form>
        </div>
    </div>

    <div id="addProductModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3>Add New Product</h3>
                <button class="close-modal" onclick="hideModal('addProductModal')">&times;</button>
            </div>
            <form onsubmit="addProduct(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Product Name</label>
                        <input type="text" class="form-input" id="productName" placeholder="Enter product name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Product Code/SKU</label>
                        <input type="text" class="form-input" id="productSKU" placeholder="Enter SKU" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select class="form-input" id="productCategory" required>
                            <option value="">Select Category</option>
                            <option value="Raw Materials">Raw Materials</option>
                            <option value="Finished Goods">Finished Goods</option>
                            <option value="Packaging">Packaging Materials</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Warehouse Location</label>
                        <select class="form-input" id="productLocation" required>
                            <option value="">Select Location</option>
                            <option value="Warehouse 1">Warehouse 1</option>
                            <option value="Warehouse 2">Warehouse 2</option>
                            <option value="Warehouse 3">Warehouse 3</option>
                            <option value="Production Floor">Production Floor</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Current Stock</label>
                        <input type="number" class="form-input" id="productStock" placeholder="Enter current stock" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Minimum Stock Level</label>
                        <input type="number" class="form-input" id="productMinStock" placeholder="Enter minimum stock level" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Unit Price</label>
                        <input type="number" step="0.01" class="form-input" id="productPrice" placeholder="Enter unit price" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Reorder Quantity</label>
                        <input type="number" class="form-input" id="productReorderQty" placeholder="Enter reorder quantity" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Barcode/QR Code</label>
                        <input type="text" class="form-input" id="productBarcode" placeholder="Enter barcode or scan QR code">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Supplier</label>
                        <select class="form-input" id="productSupplier" required>
                            <option value="">Select Supplier</option>
                            <option value="Supplier A">Supplier A</option>
                            <option value="Supplier B">Supplier B</option>
                            <option value="Supplier C">Supplier C</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Product Description</label>
                    <textarea class="form-input" id="productDescription" placeholder="Enter product description" rows="3"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('addProductModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Barcode Scanner Modal -->
    <div id="barcodeScannerModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Barcode/QR Scanner</h3>
                <button class="close-modal" onclick="hideModal('barcodeScannerModal')">&times;</button>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div style="background: #f0f0f0; padding: 40px; border-radius: 10px; margin-bottom: 20px;">
                    <div style="font-size: 3rem; margin-bottom: 10px;">📷</div>
                    <p>Camera Scanner Placeholder</p>
                    <p style="font-size: 0.9rem; color: #666;">In a real implementation, this would integrate with device camera</p>
                </div>
                <div class="form-group">
                    <label class="form-label">Or Enter Barcode Manually</label>
                    <input type="text" class="form-input" id="manualBarcode" placeholder="Enter barcode manually" onchange="lookupProductByBarcode()">
                </div>
                <div id="barcodeResult" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <!-- Stock Adjustment Modal -->
    <div id="stockAdjustmentModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Stock Adjustment</h3>
                <button class="close-modal" onclick="hideModal('stockAdjustmentModal')">&times;</button>
            </div>
            <form onsubmit="processStockAdjustment(event)">
                <div class="form-group">
                    <label class="form-label">Product</label>
                    <select class="form-input" id="adjustmentProduct" required onchange="loadProductStock()">
                        <option value="">Select Product</option>
                        <option value="Product X">Product X</option>
                        <option value="Product Y">Product Y</option>
                        <option value="Raw Material A">Raw Material A</option>
                        <option value="Raw Material B">Raw Material B</option>
                    </select>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Current Stock</label>
                        <input type="number" class="form-input" id="currentStockDisplay" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Adjustment Type</label>
                        <select class="form-input" id="adjustmentType" required>
                            <option value="">Select Type</option>
                            <option value="increase">Stock Increase</option>
                            <option value="decrease">Stock Decrease</option>
                            <option value="damaged">Damaged Goods</option>
                            <option value="expired">Expired Goods</option>
                            <option value="lost">Lost/Theft</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Adjustment Quantity</label>
                        <input type="number" class="form-input" id="adjustmentQuantity" placeholder="Enter quantity" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">New Stock Level</label>
                        <input type="number" class="form-input" id="newStockLevel" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Reason for Adjustment</label>
                    <textarea class="form-input" id="adjustmentReason" placeholder="Enter reason for stock adjustment" rows="3" required></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('stockAdjustmentModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Process Adjustment</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Batch Tracking Modal -->
    <div id="batchTrackingModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Batch & Expiry Tracking</h3>
                <button class="close-modal" onclick="hideModal('batchTrackingModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Select Product</label>
                <select class="form-input" id="batchProduct" onchange="loadBatchData()">
                    <option value="">Select Product</option>
                    <option value="Product X">Product X</option>
                    <option value="Product Y">Product Y</option>
                    <option value="Raw Material A">Raw Material A</option>
                </select>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Batch Number</th>
                        <th>Quantity</th>
                        <th>Manufacturing Date</th>
                        <th>Expiry Date</th>
                        <th>Status</th>
                        <th>Location</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="batchTrackingTableBody">
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 20px;">Select a product to view batch information</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="addStaffModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3>Add New Staff Member</h3>
                <button class="close-modal" onclick="hideModal('addStaffModal')">&times;</button>
            </div>
            <form onsubmit="addStaff(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-input" id="staffName" placeholder="Enter full name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Employee ID</label>
                        <input type="text" class="form-input" id="staffId" placeholder="Enter employee ID" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Role</label>
                        <select class="form-input" id="staffRole" required>
                            <option value="">Select Role</option>
                            <option value="Manager">Manager</option>
                            <option value="Supervisor">Supervisor</option>
                            <option value="Operator">Operator</option>
                            <option value="Clerk">Clerk</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Department</label>
                        <select class="form-input" id="staffDepartment" required>
                            <option value="">Select Department</option>
                            <option value="Production">Production</option>
                            <option value="Logistics">Logistics</option>
                            <option value="Sales">Sales</option>
                            <option value="Finance">Finance</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="staffEmail" placeholder="Enter email address" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <input type="tel" class="form-input" id="staffPhone" placeholder="Enter phone number" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Shift</label>
                        <select class="form-input" id="staffShift" required>
                            <option value="">Select Shift</option>
                            <option value="Morning (6AM-2PM)">Morning (6AM-2PM)</option>
                            <option value="Afternoon (2PM-10PM)">Afternoon (2PM-10PM)</option>
                            <option value="Night (10PM-6AM)">Night (10PM-6AM)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Salary (Monthly)</label>
                        <input type="number" class="form-input" id="staffSalary" placeholder="Enter monthly salary" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">RFID/Biometric ID</label>
                        <input type="text" class="form-input" id="staffBiometricId" placeholder="Enter RFID/Biometric ID">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Joining Date</label>
                        <input type="date" class="form-input" id="staffJoiningDate" required>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('addStaffModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Staff</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Biometric Check-in Modal -->
    <div id="biometricCheckinModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Biometric Check-in/Check-out</h3>
                <button class="close-modal" onclick="hideModal('biometricCheckinModal')">&times;</button>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div style="background: #f0f0f0; padding: 40px; border-radius: 10px; margin-bottom: 20px;">
                    <div style="font-size: 3rem; margin-bottom: 10px;">👆</div>
                    <p>Biometric Scanner Placeholder</p>
                    <p style="font-size: 0.9rem; color: #666;">In a real implementation, this would integrate with biometric scanner</p>
                </div>
                <div class="form-group">
                    <label class="form-label">Or Enter Employee ID Manually</label>
                    <input type="text" class="form-input" id="manualEmployeeId" placeholder="Enter Employee ID" onchange="lookupEmployee()">
                </div>
                <div id="employeeLookupResult" style="margin-top: 20px;"></div>
                <div style="margin-top: 20px;">
                    <button class="btn btn-success" onclick="processCheckin()" style="margin-right: 10px;">Check-in</button>
                    <button class="btn btn-danger" onclick="processCheckout()">Check-out</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Shift Schedule Modal -->
    <div id="shiftScheduleModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Shift Schedule Management</h3>
                <button class="close-modal" onclick="hideModal('shiftScheduleModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Select Date</label>
                <input type="date" class="form-input" id="scheduleDate" onchange="loadShiftSchedule()">
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Department</th>
                        <th>Current Shift</th>
                        <th>Assigned Shift</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="shiftScheduleTableBody">
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 20px;">Select a date to view shift schedule</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Performance Report Modal -->
    <div id="performanceReportModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Performance Report</h3>
                <button class="close-modal" onclick="hideModal('performanceReportModal')">&times;</button>
            </div>
            <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                <select class="form-input" id="performancePeriod" style="width: 150px;">
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                    <option value="quarterly">Quarterly</option>
                </select>
                <input type="date" class="form-input" id="performanceStartDate" style="width: 150px;">
                <input type="date" class="form-input" id="performanceEndDate" style="width: 150px;">
                <button class="btn btn-primary" onclick="generatePerformanceReport()">Generate Report</button>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Department</th>
                        <th>Tasks Completed</th>
                        <th>Hours Worked</th>
                        <th>Productivity Score</th>
                        <th>Attendance Rate</th>
                        <th>Rating</th>
                    </tr>
                </thead>
                <tbody id="performanceReportTableBody">
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 20px;">Generate report to view performance data</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Create Invoice Modal -->
    <div id="createInvoiceModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Create GST-Compliant Invoice</h3>
                <button class="close-modal" onclick="hideModal('createInvoiceModal')">&times;</button>
            </div>
            <form onsubmit="createInvoice(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Invoice Number</label>
                        <input type="text" class="form-input" id="invoiceNumber" placeholder="Auto-generated" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Invoice Date</label>
                        <input type="date" class="form-input" id="invoiceDate" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Customer</label>
                        <select class="form-input" id="invoiceCustomer" required onchange="loadCustomerDetails()">
                            <option value="">Select Customer</option>
                            <option value="ABC Distributors">ABC Distributors</option>
                            <option value="XYZ Retail">XYZ Retail</option>
                            <option value="Direct Customer">Direct Customer</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Currency</label>
                        <select class="form-input" id="invoiceCurrency" required onchange="updateCurrencyRate()">
                            <option value="INR">INR (₹)</option>
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (€)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Customer Details</label>
                    <div id="customerDetails" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <p>Select a customer to view details</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Items</label>
                    <div id="invoiceItems">
                        <div class="invoice-item" style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr auto; gap: 10px; align-items: center; margin-bottom: 10px;">
                            <select class="form-input" onchange="updateItemPrice(this)">
                                <option value="">Select Item</option>
                                <option value="Product X" data-price="155.00">Product X</option>
                                <option value="Product Y" data-price="225.00">Product Y</option>
                                <option value="Raw Material A" data-price="25.50">Raw Material A</option>
                            </select>
                            <input type="number" class="form-input" placeholder="Qty" onchange="calculateItemTotal(this)">
                            <input type="number" step="0.01" class="form-input" placeholder="Rate" readonly>
                            <input type="number" step="0.01" class="form-input" placeholder="GST%" value="18">
                            <input type="number" step="0.01" class="form-input" placeholder="Total" readonly>
                            <button type="button" class="btn btn-danger btn-sm" onclick="removeInvoiceItem(this)">Remove</button>
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary btn-sm" onclick="addInvoiceItem()">Add Item</button>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Payment Terms</label>
                        <select class="form-input" id="invoicePaymentTerms" required>
                            <option value="COD">Cash on Delivery</option>
                            <option value="Net15">Net 15 Days</option>
                            <option value="Net30">Net 30 Days</option>
                            <option value="Advance">Advance Payment</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Due Date</label>
                        <input type="date" class="form-input" id="invoiceDueDate" required>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('createInvoiceModal')">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="previewInvoice()">Preview</button>
                    <button type="submit" class="btn btn-success">Create Invoice</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Payment Gateway Modal -->
    <div id="paymentGatewayModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Process Payment</h3>
                <button class="close-modal" onclick="hideModal('paymentGatewayModal')">&times;</button>
            </div>
            <form onsubmit="processPayment(event)">
                <div class="form-group">
                    <label class="form-label">Invoice/Order ID</label>
                    <input type="text" class="form-input" id="paymentInvoiceId" placeholder="Enter invoice or order ID" required>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <input type="number" step="0.01" class="form-input" id="paymentAmount" placeholder="Enter amount" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Currency</label>
                        <select class="form-input" id="paymentCurrency" required>
                            <option value="INR">INR (₹)</option>
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (€)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Payment Method</label>
                    <select class="form-input" id="paymentMethod" required onchange="updatePaymentFields()">
                        <option value="">Select Payment Method</option>
                        <option value="card">Credit/Debit Card</option>
                        <option value="upi">UPI</option>
                        <option value="netbanking">Net Banking</option>
                        <option value="wallet">Digital Wallet</option>
                        <option value="cash">Cash</option>
                        <option value="cheque">Cheque</option>
                    </select>
                </div>
                
                <div id="paymentFields" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Card Number</label>
                        <input type="text" class="form-input" id="cardNumber" placeholder="Enter card number">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="form-group">
                            <label class="form-label">Expiry Date</label>
                            <input type="text" class="form-input" id="cardExpiry" placeholder="MM/YY">
                        </div>
                        <div class="form-group">
                            <label class="form-label">CVV</label>
                            <input type="text" class="form-input" id="cardCVV" placeholder="CVV">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Payment Reference</label>
                    <input type="text" class="form-input" id="paymentReference" placeholder="Enter payment reference">
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('paymentGatewayModal')">Cancel</button>
                    <button type="submit" class="btn btn-success">Process Payment</button>
                </div>
            </form>
        </div>
    </div>

    <!-- GST Settings Modal -->
    <div id="gstSettingsModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>GST Settings</h3>
                <button class="close-modal" onclick="hideModal('gstSettingsModal')">&times;</button>
            </div>
            <form onsubmit="saveGSTSettings(event)">
                <div class="form-group">
                    <label class="form-label">GST Number</label>
                    <input type="text" class="form-input" id="gstNumber" placeholder="Enter GST number" required>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">CGST Rate (%)</label>
                        <input type="number" step="0.01" class="form-input" id="cgstRate" placeholder="Enter CGST rate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">SGST Rate (%)</label>
                        <input type="number" step="0.01" class="form-input" id="sgstRate" placeholder="Enter SGST rate" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">IGST Rate (%)</label>
                    <input type="number" step="0.01" class="form-input" id="igstRate" placeholder="Enter IGST rate" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Business Address</label>
                    <textarea class="form-input" id="businessAddress" placeholder="Enter business address" rows="3" required></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('gstSettingsModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Currency Settings Modal -->
    <div id="currencySettingsModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Currency Settings</h3>
                <button class="close-modal" onclick="hideModal('currencySettingsModal')">&times;</button>
            </div>
            <form onsubmit="saveCurrencySettings(event)">
                <div class="form-group">
                    <label class="form-label">Base Currency</label>
                    <select class="form-input" id="baseCurrency" required>
                        <option value="INR">INR (₹)</option>
                        <option value="USD">USD ($)</option>
                        <option value="EUR">EUR (€)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Exchange Rates</label>
                    <div id="exchangeRates">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                            <input type="text" class="form-input" value="USD" readonly>
                            <input type="number" step="0.0001" class="form-input" id="usdRate" placeholder="Exchange rate">
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                            <input type="text" class="form-input" value="EUR" readonly>
                            <input type="number" step="0.0001" class="form-input" id="eurRate" placeholder="Exchange rate">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Auto Update Rates</label>
                    <input type="checkbox" id="autoUpdateRates"> Update exchange rates automatically
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('currencySettingsModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Tax Report Modal -->
    <div id="taxReportModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Tax Report</h3>
                <button class="close-modal" onclick="hideModal('taxReportModal')">&times;</button>
            </div>
            <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                <select class="form-input" id="taxReportPeriod" style="width: 150px;">
                    <option value="monthly">Monthly</option>
                    <option value="quarterly">Quarterly</option>
                    <option value="yearly">Yearly</option>
                </select>
                <input type="date" class="form-input" id="taxReportStartDate" style="width: 150px;">
                <input type="date" class="form-input" id="taxReportEndDate" style="width: 150px;">
                <button class="btn btn-primary" onclick="generateTaxReport()">Generate Report</button>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Period</th>
                        <th>Sales</th>
                        <th>CGST</th>
                        <th>SGST</th>
                        <th>IGST</th>
                        <th>Total GST</th>
                        <th>Net Amount</th>
                    </tr>
                </thead>
                <tbody id="taxReportTableBody">
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 20px;">Generate report to view tax data</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add Transaction Modal -->
    <div id="addTransactionModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Add Transaction</h3>
                <button class="close-modal" onclick="hideModal('addTransactionModal')">&times;</button>
            </div>
            <form onsubmit="addTransaction(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Transaction Type</label>
                        <select class="form-input" id="transactionType" required>
                            <option value="">Select Type</option>
                            <option value="Sale">Sale</option>
                            <option value="Purchase">Purchase</option>
                            <option value="Expense">Expense</option>
                            <option value="Payment">Payment</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Currency</label>
                        <select class="form-input" id="transactionCurrency" required>
                            <option value="INR">INR (₹)</option>
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (€)</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <input type="number" step="0.01" class="form-input" id="transactionAmount" placeholder="Enter amount" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">GST Amount</label>
                        <input type="number" step="0.01" class="form-input" id="transactionGST" placeholder="Enter GST amount">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-input" id="transactionDescription" placeholder="Enter description" rows="3" required></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('addTransactionModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Transaction</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Supplier Modal -->
    <div id="addSupplierModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3>Add New Supplier</h3>
                <button class="close-modal" onclick="hideModal('addSupplierModal')">&times;</button>
            </div>
            <form onsubmit="addSupplier(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Company Name</label>
                        <input type="text" class="form-input" id="supplierCompanyName" placeholder="Enter company name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Supplier ID</label>
                        <input type="text" class="form-input" id="supplierId" placeholder="Auto-generated" readonly>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Contact Person</label>
                        <input type="text" class="form-input" id="supplierContactPerson" placeholder="Enter contact person" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Designation</label>
                        <input type="text" class="form-input" id="supplierDesignation" placeholder="Enter designation">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="supplierEmail" placeholder="Enter email" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <input type="tel" class="form-input" id="supplierPhone" placeholder="Enter phone number" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select class="form-input" id="supplierCategory" required>
                            <option value="">Select Category</option>
                            <option value="Raw Materials">Raw Materials</option>
                            <option value="Packaging">Packaging</option>
                            <option value="Equipment">Equipment</option>
                            <option value="Services">Services</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-input" id="supplierStatus" required>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                            <option value="Preferred">Preferred</option>
                            <option value="Blacklisted">Blacklisted</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Address</label>
                    <textarea class="form-input" id="supplierAddress" placeholder="Enter complete address" rows="3" required></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">GST Number</label>
                        <input type="text" class="form-input" id="supplierGST" placeholder="Enter GST number">
                    </div>
                    <div class="form-group">
                        <label class="form-label">PAN Number</label>
                        <input type="text" class="form-input" id="supplierPAN" placeholder="Enter PAN number">
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('addSupplierModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Supplier</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Purchase Order Modal -->
    <div id="createPurchaseOrderModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Create Purchase Order</h3>
                <button class="close-modal" onclick="hideModal('createPurchaseOrderModal')">&times;</button>
            </div>
            <form onsubmit="createPurchaseOrder(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">PO Number</label>
                        <input type="text" class="form-input" id="poNumber" placeholder="Auto-generated" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">PO Date</label>
                        <input type="date" class="form-input" id="poDate" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Supplier</label>
                        <select class="form-input" id="poSupplier" required onchange="loadSupplierDetails()">
                            <option value="">Select Supplier</option>
                            <option value="ABC Materials Ltd">ABC Materials Ltd</option>
                            <option value="XYZ Packaging Co">XYZ Packaging Co</option>
                            <option value="DEF Equipment Inc">DEF Equipment Inc</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Expected Delivery</label>
                        <input type="date" class="form-input" id="poExpectedDelivery" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Supplier Details</label>
                    <div id="supplierDetails" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <p>Select a supplier to view details</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Items</label>
                    <div id="poItems">
                        <div class="po-item" style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr auto; gap: 10px; align-items: center; margin-bottom: 10px;">
                            <input type="text" class="form-input" placeholder="Item Description">
                            <input type="number" class="form-input" placeholder="Qty" onchange="calculatePOItemTotal(this)">
                            <input type="number" step="0.01" class="form-input" placeholder="Rate">
                            <input type="number" step="0.01" class="form-input" placeholder="Total" readonly>
                            <button type="button" class="btn btn-danger btn-sm" onclick="removePOItem(this)">Remove</button>
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary btn-sm" onclick="addPOItem()">Add Item</button>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Payment Terms</label>
                        <select class="form-input" id="poPaymentTerms" required>
                            <option value="Net30">Net 30 Days</option>
                            <option value="Net15">Net 15 Days</option>
                            <option value="COD">Cash on Delivery</option>
                            <option value="Advance">Advance Payment</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Priority</label>
                        <select class="form-input" id="poPriority" required>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Urgent">Urgent</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Special Instructions</label>
                    <textarea class="form-input" id="poInstructions" placeholder="Enter special instructions" rows="3"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('createPurchaseOrderModal')">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="previewPurchaseOrder()">Preview</button>
                    <button type="submit" class="btn btn-success">Create PO</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Supplier Settlement Modal -->
    <div id="supplierSettlementModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Supplier Settlement</h3>
                <button class="close-modal" onclick="hideModal('supplierSettlementModal')">&times;</button>
            </div>
            <form onsubmit="processSupplierSettlement(event)">
                <div class="form-group">
                    <label class="form-label">Supplier</label>
                    <select class="form-input" id="settlementSupplier" required>
                        <option value="">Select Supplier</option>
                        <option value="ABC Materials Ltd">ABC Materials Ltd</option>
                        <option value="XYZ Packaging Co">XYZ Packaging Co</option>
                        <option value="DEF Equipment Inc">DEF Equipment Inc</option>
                    </select>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Invoice Number</label>
                        <input type="text" class="form-input" id="settlementInvoiceNumber" placeholder="Enter invoice number" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Amount</label>
                        <input type="number" step="0.01" class="form-input" id="settlementAmount" placeholder="Enter amount" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Due Date</label>
                        <input type="date" class="form-input" id="settlementDueDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Payment Method</label>
                        <select class="form-input" id="settlementPaymentMethod" required>
                            <option value="Bank Transfer">Bank Transfer</option>
                            <option value="Cheque">Cheque</option>
                            <option value="Cash">Cash</option>
                            <option value="UPI">UPI</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Payment Reference</label>
                    <input type="text" class="form-input" id="settlementReference" placeholder="Enter payment reference">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Notes</label>
                    <textarea class="form-input" id="settlementNotes" placeholder="Enter additional notes" rows="3"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('supplierSettlementModal')">Cancel</button>
                    <button type="submit" class="btn btn-success">Process Settlement</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Contract Modal -->
    <div id="addContractModal" class="modal-overlay hidden" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Add Supplier Contract</h3>
                <button class="close-modal" onclick="hideModal('addContractModal')">&times;</button>
            </div>
            <form onsubmit="addContract(event)">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Contract ID</label>
                        <input type="text" class="form-input" id="contractId" placeholder="Auto-generated" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Supplier</label>
                        <select class="form-input" id="contractSupplier" required>
                            <option value="">Select Supplier</option>
                            <option value="ABC Materials Ltd">ABC Materials Ltd</option>
                            <option value="XYZ Packaging Co">XYZ Packaging Co</option>
                            <option value="DEF Equipment Inc">DEF Equipment Inc</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Contract Type</label>
                        <select class="form-input" id="contractType" required>
                            <option value="Supply Agreement">Supply Agreement</option>
                            <option value="Service Contract">Service Contract</option>
                            <option value="Maintenance Contract">Maintenance Contract</option>
                            <option value="Exclusive Agreement">Exclusive Agreement</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Contract Value</label>
                        <input type="number" step="0.01" class="form-input" id="contractValue" placeholder="Enter contract value" required>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">Start Date</label>
                        <input type="date" class="form-input" id="contractStartDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Date</label>
                        <input type="date" class="form-input" id="contractEndDate" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Contract Terms</label>
                    <textarea class="form-input" id="contractTerms" placeholder="Enter contract terms and conditions" rows="4" required></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-danger" onclick="hideModal('addContractModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Contract</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

    <script>
        // Enhanced Mock Data
        let orders = [
            { 
                id: 'ORD-2024-001', 
                type: 'Customer', 
                customer: 'ABC Distributors', 
                amount: 25400, 
                status: 'Delivered', 
                priority: 'High',
                date: '2024-09-25',
                deliveryDate: '2024-09-27',
                paymentTerms: 'Net30',
                instructions: 'Handle with care',
                approvedBy: 'John Smith',
                approvedDate: '2024-09-25'
            },
            { 
                id: 'ORD-2024-002', 
                type: 'Distributor', 
                customer: 'XYZ Retail', 
                amount: 18750, 
                status: 'Dispatched', 
                priority: 'Normal',
                date: '2024-09-25',
                deliveryDate: '2024-09-28',
                paymentTerms: 'Net15',
                instructions: 'Priority delivery',
                approvedBy: 'Sarah Johnson',
                approvedDate: '2024-09-25'
            },
            { 
                id: 'ORD-2024-003', 
                type: 'Customer', 
                customer: 'Direct Customer', 
                amount: 12300, 
                status: 'In Production', 
                priority: 'Normal',
                date: '2024-09-24',
                deliveryDate: '2024-09-30',
                paymentTerms: 'COD',
                instructions: 'Standard processing',
                approvedBy: 'Mike Wilson',
                approvedDate: '2024-09-24'
            },
            { 
                id: 'ORD-2024-004', 
                type: 'Production', 
                customer: 'Internal', 
                amount: 35600, 
                status: 'Pending', 
                priority: 'Urgent',
                date: '2024-09-24',
                deliveryDate: '2024-09-26',
                paymentTerms: 'Advance',
                instructions: 'Urgent production order',
                approvedBy: null,
                approvedDate: null
            },
            { 
                id: 'ORD-2024-005', 
                type: 'Internal', 
                customer: 'Branch Transfer', 
                amount: 8900, 
                status: 'Cancelled', 
                priority: 'Normal',
                date: '2024-09-23',
                deliveryDate: '2024-09-25',
                paymentTerms: 'Internal',
                instructions: 'Branch transfer cancelled',
                approvedBy: 'David Lee',
                approvedDate: '2024-09-23'
            }
        ];

        let inventory = [
            { 
                name: 'Raw Material A', 
                sku: 'RM-A-001',
                category: 'Raw Materials', 
                stock: 500, 
                minStock: 100, 
                price: 25.50, 
                location: 'Warehouse 1',
                reorderQty: 200,
                supplier: 'Supplier A',
                barcode: '1234567890123',
                description: 'High quality raw material for production'
            },
            { 
                name: 'Product X', 
                sku: 'PRD-X-001',
                category: 'Finished Goods', 
                stock: 75, 
                minStock: 100, 
                price: 155.00, 
                location: 'Warehouse 2',
                reorderQty: 150,
                supplier: 'Supplier B',
                barcode: '2345678901234',
                description: 'Premium finished product'
            },
            { 
                name: 'Packaging Box', 
                sku: 'PKG-B-001',
                category: 'Packaging', 
                stock: 200, 
                minStock: 50, 
                price: 5.25, 
                location: 'Warehouse 1',
                reorderQty: 100,
                supplier: 'Supplier C',
                barcode: '3456789012345',
                description: 'Standard packaging material'
            },
            { 
                name: 'Raw Material B', 
                sku: 'RM-B-001',
                category: 'Raw Materials', 
                stock: 25, 
                minStock: 50, 
                price: 45.75, 
                location: 'Warehouse 3',
                reorderQty: 100,
                supplier: 'Supplier A',
                barcode: '4567890123456',
                description: 'Secondary raw material'
            },
            { 
                name: 'Product Y', 
                sku: 'PRD-Y-001',
                category: 'Finished Goods', 
                stock: 150, 
                minStock: 80, 
                price: 225.00, 
                location: 'Warehouse 2',
                reorderQty: 120,
                supplier: 'Supplier B',
                barcode: '5678901234567',
                description: 'Deluxe finished product'
            }
        ];

        // Batch tracking data
        let batchData = {
            'Product X': [
                { batchNumber: 'BATCH-X-001', quantity: 50, manufacturingDate: '2024-08-15', expiryDate: '2025-08-15', status: 'Active', location: 'Warehouse 2' },
                { batchNumber: 'BATCH-X-002', quantity: 25, manufacturingDate: '2024-09-01', expiryDate: '2025-09-01', status: 'Active', location: 'Warehouse 2' }
            ],
            'Product Y': [
                { batchNumber: 'BATCH-Y-001', quantity: 100, manufacturingDate: '2024-08-20', expiryDate: '2025-08-20', status: 'Active', location: 'Warehouse 2' },
                { batchNumber: 'BATCH-Y-002', quantity: 50, manufacturingDate: '2024-09-05', expiryDate: '2025-09-05', status: 'Active', location: 'Warehouse 2' }
            ],
            'Raw Material A': [
                { batchNumber: 'BATCH-RM-A-001', quantity: 300, manufacturingDate: '2024-08-10', expiryDate: '2025-08-10', status: 'Active', location: 'Warehouse 1' },
                { batchNumber: 'BATCH-RM-A-002', quantity: 200, manufacturingDate: '2024-09-01', expiryDate: '2025-09-01', status: 'Active', location: 'Warehouse 1' }
            ]
        };

        let staff = [
            { 
                id: 'EMP001', 
                name: 'John Smith', 
                role: 'Manager', 
                department: 'Production', 
                status: 'Present', 
                email: 'john.smith@company.com', 
                phone: '+91-9876543210',
                shift: 'Morning (6AM-2PM)',
                salary: 75000,
                biometricId: 'BIO001',
                joiningDate: '2023-01-15',
                checkinTime: '06:15',
                checkoutTime: null,
                productivityScore: 95,
                attendanceRate: 98
            },
            { 
                id: 'EMP002', 
                name: 'Sarah Johnson', 
                role: 'Supervisor', 
                department: 'Logistics', 
                status: 'Present', 
                email: 'sarah.johnson@company.com', 
                phone: '+91-9876543211',
                shift: 'Afternoon (2PM-10PM)',
                salary: 55000,
                biometricId: 'BIO002',
                joiningDate: '2023-03-20',
                checkinTime: '14:00',
                checkoutTime: null,
                productivityScore: 92,
                attendanceRate: 96
            },
            { 
                id: 'EMP003', 
                name: 'Mike Wilson', 
                role: 'Operator', 
                department: 'Production', 
                status: 'On Leave', 
                email: 'mike.wilson@company.com', 
                phone: '+91-9876543212',
                shift: 'Morning (6AM-2PM)',
                salary: 35000,
                biometricId: 'BIO003',
                joiningDate: '2023-05-10',
                checkinTime: null,
                checkoutTime: null,
                productivityScore: 88,
                attendanceRate: 94
            },
            { 
                id: 'EMP004', 
                name: 'Lisa Brown', 
                role: 'Clerk', 
                department: 'Finance', 
                status: 'Present', 
                email: 'lisa.brown@company.com', 
                phone: '+91-9876543213',
                shift: 'Morning (6AM-2PM)',
                salary: 30000,
                biometricId: 'BIO004',
                joiningDate: '2023-02-28',
                checkinTime: '06:30',
                checkoutTime: null,
                productivityScore: 90,
                attendanceRate: 97
            },
            { 
                id: 'EMP005', 
                name: 'David Lee', 
                role: 'Manager', 
                department: 'Sales', 
                status: 'Present', 
                email: 'david.lee@company.com', 
                phone: '+91-9876543214',
                shift: 'Morning (6AM-2PM)',
                salary: 70000,
                biometricId: 'BIO005',
                joiningDate: '2023-01-10',
                checkinTime: '06:00',
                checkoutTime: null,
                productivityScore: 96,
                attendanceRate: 99
            }
        ];

        // Attendance tracking data
        let attendanceData = [
            { employeeId: 'EMP001', employeeName: 'John Smith', checkinTime: '06:15', checkoutTime: null, hoursWorked: 8, overtime: 0, status: 'Present' },
            { employeeId: 'EMP002', employeeName: 'Sarah Johnson', checkinTime: '14:00', checkoutTime: null, hoursWorked: 6, overtime: 0, status: 'Present' },
            { employeeId: 'EMP003', employeeName: 'Mike Wilson', checkinTime: null, checkoutTime: null, hoursWorked: 0, overtime: 0, status: 'On Leave' },
            { employeeId: 'EMP004', employeeName: 'Lisa Brown', checkinTime: '06:30', checkoutTime: null, hoursWorked: 7.5, overtime: 0, status: 'Present' },
            { employeeId: 'EMP005', employeeName: 'David Lee', checkinTime: '06:00', checkoutTime: null, hoursWorked: 8, overtime: 0, status: 'Present' }
        ];

        let customers = [
            { id: 'CUST001', name: 'ABC Distributors', email: 'contact@abcdist.com', phone: '+91-9876543220', loyaltyPoints: 2500, lastOrder: '2024-09-25' },
            { id: 'CUST002', name: 'XYZ Retail', email: 'orders@xyzretail.com', phone: '+91-9876543221', loyaltyPoints: 1800, lastOrder: '2024-09-24' },
            { id: 'CUST003', name: 'Direct Customer 1', email: 'customer1@gmail.com', phone: '+91-9876543222', loyaltyPoints: 450, lastOrder: '2024-09-20' },
            { id: 'CUST004', name: 'PQR Wholesale', email: 'info@pqrwholesale.com', phone: '+91-9876543223', loyaltyPoints: 3200, lastOrder: '2024-09-23' },
            { id: 'CUST005', name: 'LMN Stores', email: 'purchase@lmnstores.com', phone: '+91-9876543224', loyaltyPoints: 980, lastOrder: '2024-09-22' }
        ];

        let transactions = [
            { 
                id: 'TXN001', 
                date: '2024-09-25', 
                type: 'Sale', 
                amount: 25400, 
                currency: 'INR',
                gst: 4572,
                description: 'Product X sale to ABC Distributors',
                status: 'Completed' 
            },
            { 
                id: 'TXN002', 
                date: '2024-09-25', 
                type: 'Purchase', 
                amount: -12500, 
                currency: 'INR',
                gst: 2250,
                description: 'Raw material purchase from Supplier A',
                status: 'Completed' 
            },
            { 
                id: 'TXN003', 
                date: '2024-09-24', 
                type: 'Sale', 
                amount: 18750, 
                currency: 'USD',
                gst: 3375,
                description: 'Product Y export sale',
                status: 'Pending' 
            },
            { 
                id: 'TXN004', 
                date: '2024-09-24', 
                type: 'Expense', 
                amount: -3400, 
                currency: 'INR',
                gst: 0,
                description: 'Office maintenance expense',
                status: 'Completed' 
            },
            { 
                id: 'TXN005', 
                date: '2024-09-23', 
                type: 'Sale', 
                amount: 35600, 
                currency: 'INR',
                gst: 6408,
                description: 'Bulk order from XYZ Retail',
                status: 'Completed' 
            }
        ];

        // Receivables and Payables data
        let receivables = [
            { customer: 'ABC Distributors', amount: 25400, dueDate: '2024-10-25', status: 'Pending' },
            { customer: 'XYZ Retail', amount: 18750, dueDate: '2024-10-24', status: 'Overdue' },
            { customer: 'Direct Customer', amount: 12300, dueDate: '2024-10-30', status: 'Pending' }
        ];

        let payables = [
            { supplier: 'Supplier A', amount: 12500, dueDate: '2024-10-15', status: 'Pending' },
            { supplier: 'Supplier B', amount: 8900, dueDate: '2024-10-20', status: 'Pending' },
            { supplier: 'Supplier C', amount: 5600, dueDate: '2024-10-10', status: 'Overdue' }
        ];

        // GST Settings
        let gstSettings = {
            gstNumber: '29ABCDE1234F1Z5',
            cgstRate: 9,
            sgstRate: 9,
            igstRate: 18,
            businessAddress: '123 Business Park, Industrial Area, Mumbai, Maharashtra - 400001'
        };

        // Currency Settings
        let currencySettings = {
            baseCurrency: 'INR',
            exchangeRates: {
                USD: 83.25,
                EUR: 89.50
            },
            autoUpdate: true
        };

        // Supplier Management Data
        let suppliers = [
            {
                id: 'SUP001',
                companyName: 'ABC Materials Ltd',
                contactPerson: 'John Smith',
                designation: 'Sales Manager',
                email: 'john@abcmaterials.com',
                phone: '+91-9876543210',
                category: 'Raw Materials',
                status: 'Active',
                rating: 4.5,
                address: '123 Industrial Area, Mumbai, Maharashtra - 400001',
                gst: '27ABCDE1234F1Z5',
                pan: 'ABCDE1234F',
                lastOrder: '2024-09-25',
                totalValue: 1250000
            },
            {
                id: 'SUP002',
                companyName: 'XYZ Packaging Co',
                contactPerson: 'Sarah Johnson',
                designation: 'Business Development',
                email: 'sarah@xyzpackaging.com',
                phone: '+91-9876543211',
                category: 'Packaging',
                status: 'Preferred',
                rating: 4.8,
                address: '456 Packaging Hub, Delhi, Delhi - 110001',
                gst: '07FGHIJ5678K2L6',
                pan: 'FGHIJ5678K',
                lastOrder: '2024-09-24',
                totalValue: 890000
            },
            {
                id: 'SUP003',
                companyName: 'DEF Equipment Inc',
                contactPerson: 'Mike Wilson',
                designation: 'Technical Director',
                email: 'mike@defequipment.com',
                phone: '+91-9876543212',
                category: 'Equipment',
                status: 'Active',
                rating: 4.2,
                address: '789 Tech Park, Bangalore, Karnataka - 560001',
                gst: '29KLMNO9012P3Q7',
                pan: 'KLMNO9012P',
                lastOrder: '2024-09-23',
                totalValue: 2100000
            }
        ];

        let purchaseOrders = [
            {
                poNumber: 'PO001',
                supplier: 'ABC Materials Ltd',
                date: '2024-09-25',
                items: 5,
                amount: 125000,
                status: 'Pending',
                expectedDelivery: '2024-10-02',
                priority: 'High'
            },
            {
                poNumber: 'PO002',
                supplier: 'XYZ Packaging Co',
                date: '2024-09-24',
                items: 3,
                amount: 89000,
                status: 'Completed',
                expectedDelivery: '2024-09-30',
                priority: 'Medium'
            },
            {
                poNumber: 'PO003',
                supplier: 'DEF Equipment Inc',
                date: '2024-09-23',
                items: 2,
                amount: 210000,
                status: 'In Transit',
                expectedDelivery: '2024-10-05',
                priority: 'Urgent'
            }
        ];

        let settlements = [
            {
                supplier: 'ABC Materials Ltd',
                invoiceNumber: 'INV-ABC-001',
                amount: 125000,
                dueDate: '2024-10-25',
                status: 'Pending',
                paymentMethod: 'Bank Transfer'
            },
            {
                supplier: 'XYZ Packaging Co',
                invoiceNumber: 'INV-XYZ-002',
                amount: 89000,
                dueDate: '2024-10-24',
                status: 'Paid',
                paymentMethod: 'Cheque'
            },
            {
                supplier: 'DEF Equipment Inc',
                invoiceNumber: 'INV-DEF-003',
                amount: 210000,
                dueDate: '2024-10-23',
                status: 'Overdue',
                paymentMethod: 'Bank Transfer'
            }
        ];

        let contracts = [
            {
                contractId: 'CON001',
                supplier: 'ABC Materials Ltd',
                type: 'Supply Agreement',
                startDate: '2024-01-01',
                endDate: '2024-12-31',
                value: 1500000,
                status: 'Active'
            },
            {
                contractId: 'CON002',
                supplier: 'XYZ Packaging Co',
                type: 'Exclusive Agreement',
                startDate: '2024-06-01',
                endDate: '2025-05-31',
                value: 800000,
                status: 'Active'
            },
            {
                contractId: 'CON003',
                supplier: 'DEF Equipment Inc',
                type: 'Maintenance Contract',
                startDate: '2024-03-01',
                endDate: '2025-02-28',
                value: 500000,
                status: 'Active'
            }
        ];

        let productionOrders = [
            { id: 'WO001', product: 'Product X', quantity: 100, status: 'In Progress', startDate: '2024-09-20', expectedCompletion: '2024-09-27' },
            { id: 'WO002', product: 'Product Y', quantity: 200, status: 'Completed', startDate: '2024-09-18', expectedCompletion: '2024-09-25' },
            { id: 'WO003', product: 'Product Z', quantity: 150, status: 'Pending', startDate: '2024-09-26', expectedCompletion: '2024-10-03' },
            { id: 'WO004', product: 'Product A', quantity: 75, status: 'In Progress', startDate: '2024-09-22', expectedCompletion: '2024-09-29' }
        ];

        let deliveries = [
            { id: 'DEL001', orderId: 'ORD-2024-001', customer: 'ABC Distributors', vehicle: 'TN-01-AB-1234', driver: 'Raj Kumar', status: 'In Transit', eta: '14:30' },
            { id: 'DEL002', orderId: 'ORD-2024-002', customer: 'XYZ Retail', vehicle: 'TN-01-CD-5678', driver: 'Suresh Babu', status: 'Delivered', eta: 'Completed' },
            { id: 'DEL003', orderId: 'ORD-2024-003', customer: 'Direct Customer', vehicle: 'TN-01-EF-9012', driver: 'Mohan Das', status: 'Scheduled', eta: '16:00' },
            { id: 'DEL004', orderId: 'ORD-2024-004', customer: 'PQR Wholesale', vehicle: 'TN-01-GH-3456', driver: 'Kumar Singh', status: 'Loading', eta: '15:45' }
        ];

        // Navigation Functions
        function showSection(sectionId, event) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update active nav item
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            if (event && event.currentTarget) {
                event.currentTarget.closest('.nav-item').classList.add('active');
            }
            
            // Load section data
            loadSectionData(sectionId);
        }

        function loadSectionData(sectionId) {
            switch(sectionId) {
                case 'orders':
                    loadOrdersTable();
                    break;
                case 'inventory':
                    loadInventoryGrid();
                    break;
                case 'staff':
                    loadStaffTable();
                    break;
                case 'accounting':
                    loadTransactionTable();
                    break;
                case 'crm':
                    loadCustomerTable();
                    break;
                case 'suppliers':
                    loadSupplierTable();
                    break;
                case 'production':
                    loadProductionTable();
                    break;
                case 'logistics':
                    loadLogisticsTable();
                    break;
                case 'reports':
                    loadSalesChart();
                    break;
            }
        }

        // Modal Functions
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('hidden');
            modal.style.display = 'flex';
        }

        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('hidden');
            modal.style.display = 'none';
        }

        // Enhanced Table Loading Functions
        function loadOrdersTable() {
            const tbody = document.getElementById('ordersTableBody');
            tbody.innerHTML = orders.map(order => `
                <tr>
                    <td><input type="checkbox" class="order-checkbox" value="${order.id}"></td>
                    <td>${order.id}</td>
                    <td>${order.type}</td>
                    <td>${order.customer}</td>
                    <td>₹${order.amount.toLocaleString()}</td>
                    <td><span class="status-badge status-${order.status.toLowerCase().replace(/\s+/g, '')}">${order.status}</span></td>
                    <td><span class="status-badge ${order.priority === 'Urgent' ? 'status-cancelled' : order.priority === 'High' ? 'status-pending' : 'status-delivered'}">${order.priority}</span></td>
                    <td>${order.date}</td>
                    <td>${order.deliveryDate}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewOrder('${order.id}')">View</button>
                        ${order.status === 'Pending' ? `<button class="btn btn-success btn-sm" onclick="approveOrder('${order.id}')">Approve</button>` : ''}
                        ${order.status === 'Approved' ? `<button class="btn btn-success btn-sm" onclick="startProduction('${order.id}')">Start Production</button>` : ''}
                        ${order.status === 'In Production' ? `<button class="btn btn-success btn-sm" onclick="dispatchOrder('${order.id}')">Dispatch</button>` : ''}
                        <button class="btn btn-danger btn-sm" onclick="cancelOrder('${order.id}')">Cancel</button>
                    </td>
                </tr>
            `).join('');
            
            updateOrderWorkflowStats();
        }

        function loadInventoryGrid() {
            const grid = document.getElementById('inventoryGrid');
            grid.innerHTML = inventory.map(item => `
                <div class="inventory-item ${item.stock <= item.minStock ? 'low-stock' : ''}">
                    <h4>${item.name}</h4>
                    <div class="inventory-details">
                        <p><strong>SKU:</strong> ${item.sku}</p>
                        <p><strong>Category:</strong> ${item.category}</p>
                        <p><strong>Current Stock:</strong> ${item.stock} units</p>
                        <p><strong>Min Stock:</strong> ${item.minStock} units</p>
                        <p><strong>Unit Price:</strong> ₹${item.price}</p>
                        <p><strong>Location:</strong> ${item.location}</p>
                        <p><strong>Supplier:</strong> ${item.supplier}</p>
                        <p><strong>Barcode:</strong> ${item.barcode}</p>
                        ${item.stock <= item.minStock ? '<p style="color: #F44336;"><strong>⚠️ Low Stock Alert!</strong></p>' : ''}
                        <div style="margin-top: 10px;">
                            <button class="btn btn-primary btn-sm" onclick="viewProduct('${item.name}')">View</button>
                            <button class="btn btn-success btn-sm" onclick="adjustStock('${item.name}')">Adjust</button>
                            <button class="btn btn-primary btn-sm" onclick="viewBatch('${item.name}')">Batches</button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            updateInventoryStats();
            loadReorderAlerts();
        }

        function updateInventoryStats() {
            const totalProducts = inventory.length;
            const lowStockCount = inventory.filter(item => item.stock <= item.minStock).length;
            const outOfStockCount = inventory.filter(item => item.stock === 0).length;
            const totalValue = inventory.reduce((sum, item) => sum + (item.stock * item.price), 0);
            
            document.getElementById('totalProductsCount').textContent = totalProducts;
            document.getElementById('lowStockCount').textContent = lowStockCount;
            document.getElementById('outOfStockCount').textContent = outOfStockCount;
            document.getElementById('totalInventoryValue').textContent = `₹${totalValue.toLocaleString()}`;
        }

        function loadReorderAlerts() {
            const tbody = document.getElementById('reorderAlertsTableBody');
            const lowStockItems = inventory.filter(item => item.stock <= item.minStock);
            
            tbody.innerHTML = lowStockItems.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td>${item.stock}</td>
                    <td>${item.minStock}</td>
                    <td>${item.reorderQty}</td>
                    <td>${item.supplier}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="createPurchaseOrder('${item.name}')">Create PO</button>
                        <button class="btn btn-success btn-sm" onclick="reorderProduct('${item.name}')">Reorder</button>
                    </td>
                </tr>
            `).join('');
        }

        function filterInventory() {
            const categoryFilter = document.getElementById('inventoryCategoryFilter').value;
            const locationFilter = document.getElementById('inventoryLocationFilter').value;
            const statusFilter = document.getElementById('inventoryStatusFilter').value;
            
            let filteredInventory = inventory;
            
            if (categoryFilter) {
                filteredInventory = filteredInventory.filter(item => item.category === categoryFilter);
            }
            if (locationFilter) {
                filteredInventory = filteredInventory.filter(item => item.location === locationFilter);
            }
            if (statusFilter) {
                if (statusFilter === 'low-stock') {
                    filteredInventory = filteredInventory.filter(item => item.stock <= item.minStock && item.stock > 0);
                } else if (statusFilter === 'out-of-stock') {
                    filteredInventory = filteredInventory.filter(item => item.stock === 0);
                } else if (statusFilter === 'normal') {
                    filteredInventory = filteredInventory.filter(item => item.stock > item.minStock);
                }
            }
            
            const grid = document.getElementById('inventoryGrid');
            grid.innerHTML = filteredInventory.map(item => `
                <div class="inventory-item ${item.stock <= item.minStock ? 'low-stock' : ''}">
                    <h4>${item.name}</h4>
                    <div class="inventory-details">
                        <p><strong>SKU:</strong> ${item.sku}</p>
                        <p><strong>Category:</strong> ${item.category}</p>
                        <p><strong>Current Stock:</strong> ${item.stock} units</p>
                        <p><strong>Min Stock:</strong> ${item.minStock} units</p>
                        <p><strong>Unit Price:</strong> ₹${item.price}</p>
                        <p><strong>Location:</strong> ${item.location}</p>
                        <p><strong>Supplier:</strong> ${item.supplier}</p>
                        <p><strong>Barcode:</strong> ${item.barcode}</p>
                        ${item.stock <= item.minStock ? '<p style="color: #F44336;"><strong>⚠️ Low Stock Alert!</strong></p>' : ''}
                        <div style="margin-top: 10px;">
                            <button class="btn btn-primary btn-sm" onclick="viewProduct('${item.name}')">View</button>
                            <button class="btn btn-success btn-sm" onclick="adjustStock('${item.name}')">Adjust</button>
                            <button class="btn btn-primary btn-sm" onclick="viewBatch('${item.name}')">Batches</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function loadStaffTable() {
            const tbody = document.getElementById('staffTableBody');
            tbody.innerHTML = staff.map(member => `
                <tr>
                    <td>${member.id}</td>
                    <td>${member.name}</td>
                    <td>${member.role}</td>
                    <td>${member.department}</td>
                    <td>${member.shift}</td>
                    <td><span class="status-badge ${member.status === 'Present' ? 'status-delivered' : 'status-cancelled'}">${member.status}</span></td>
                    <td>${member.checkinTime || 'Not checked in'}</td>
                    <td>${member.productivityScore}%</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewStaff('${member.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editStaff('${member.id}')">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="viewAttendance('${member.id}')">Attendance</button>
                    </td>
                </tr>
            `).join('');
            
            loadAttendanceTable();
            updateStaffStats();
        }

        function loadAttendanceTable() {
            const tbody = document.getElementById('attendanceTableBody');
            tbody.innerHTML = attendanceData.map(attendance => `
                <tr>
                    <td>${attendance.employeeName}</td>
                    <td>${attendance.checkinTime || 'Not checked in'}</td>
                    <td>${attendance.checkoutTime || 'Not checked out'}</td>
                    <td>${attendance.hoursWorked}</td>
                    <td>${attendance.overtime}</td>
                    <td><span class="status-badge ${attendance.status === 'Present' ? 'status-delivered' : 'status-cancelled'}">${attendance.status}</span></td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="manageAttendance('${attendance.employeeId}')">Manage</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateStaffStats() {
            const totalStaff = staff.length;
            const presentToday = staff.filter(member => member.status === 'Present').length;
            const onLeave = staff.filter(member => member.status === 'On Leave').length;
            const avgAttendanceRate = staff.reduce((sum, member) => sum + member.attendanceRate, 0) / totalStaff;
            
            document.getElementById('totalStaffCount').textContent = totalStaff;
            document.getElementById('presentTodayCount').textContent = presentToday;
            document.getElementById('onLeaveCount').textContent = onLeave;
            document.getElementById('attendanceRate').textContent = `${Math.round(avgAttendanceRate)}%`;
        }

        function filterStaff() {
            const departmentFilter = document.getElementById('staffDepartmentFilter').value;
            const roleFilter = document.getElementById('staffRoleFilter').value;
            const statusFilter = document.getElementById('staffStatusFilter').value;
            
            let filteredStaff = staff;
            
            if (departmentFilter) {
                filteredStaff = filteredStaff.filter(member => member.department === departmentFilter);
            }
            if (roleFilter) {
                filteredStaff = filteredStaff.filter(member => member.role === roleFilter);
            }
            if (statusFilter) {
                filteredStaff = filteredStaff.filter(member => member.status === statusFilter);
            }
            
            const tbody = document.getElementById('staffTableBody');
            tbody.innerHTML = filteredStaff.map(member => `
                <tr>
                    <td>${member.id}</td>
                    <td>${member.name}</td>
                    <td>${member.role}</td>
                    <td>${member.department}</td>
                    <td>${member.shift}</td>
                    <td><span class="status-badge ${member.status === 'Present' ? 'status-delivered' : 'status-cancelled'}">${member.status}</span></td>
                    <td>${member.checkinTime || 'Not checked in'}</td>
                    <td>${member.productivityScore}%</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewStaff('${member.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editStaff('${member.id}')">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="viewAttendance('${member.id}')">Attendance</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadCustomerTable() {
            const tbody = document.getElementById('customerTableBody');
            tbody.innerHTML = customers.map(customer => `
                <tr>
                    <td>${customer.id}</td>
                    <td>${customer.name}</td>
                    <td>${customer.email}</td>
                    <td>${customer.phone}</td>
                    <td>${customer.loyaltyPoints}</td>
                    <td>${customer.lastOrder}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewCustomer('${customer.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editCustomer('${customer.id}')">Edit</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadTransactionTable() {
            const tbody = document.getElementById('transactionTableBody');
            tbody.innerHTML = transactions.map(transaction => `
                <tr>
                    <td>${transaction.date}</td>
                    <td>${transaction.id}</td>
                    <td>${transaction.type}</td>
                    <td>${transaction.description}</td>
                    <td style="color: ${transaction.amount > 0 ? '#4CAF50' : '#F44336'}">${getCurrencySymbol(transaction.currency)}${Math.abs(transaction.amount).toLocaleString()}</td>
                    <td>${transaction.currency}</td>
                    <td>${getCurrencySymbol(transaction.currency)}${transaction.gst.toLocaleString()}</td>
                    <td><span class="status-badge ${transaction.status === 'Completed' ? 'status-delivered' : 'status-pending'}">${transaction.status}</span></td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewTransaction('${transaction.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editTransaction('${transaction.id}')">Edit</button>
                    </td>
                </tr>
            `).join('');
            
            loadReceivablesTable();
            loadPayablesTable();
            updateFinancialStats();
        }

        function loadReceivablesTable() {
            const tbody = document.getElementById('receivablesTableBody');
            tbody.innerHTML = receivables.map(receivable => `
                <tr>
                    <td>${receivable.customer}</td>
                    <td>₹${receivable.amount.toLocaleString()}</td>
                    <td>${receivable.dueDate}</td>
                    <td><span class="status-badge ${receivable.status === 'Pending' ? 'status-pending' : 'status-cancelled'}">${receivable.status}</span></td>
                </tr>
            `).join('');
        }

        function loadPayablesTable() {
            const tbody = document.getElementById('payablesTableBody');
            tbody.innerHTML = payables.map(payable => `
                <tr>
                    <td>${payable.supplier}</td>
                    <td>₹${payable.amount.toLocaleString()}</td>
                    <td>${payable.dueDate}</td>
                    <td><span class="status-badge ${payable.status === 'Pending' ? 'status-pending' : 'status-cancelled'}">${payable.status}</span></td>
                </tr>
            `).join('');
        }

        function updateFinancialStats() {
            const monthlyRevenue = transactions.filter(t => t.type === 'Sale' && t.status === 'Completed').reduce((sum, t) => sum + Math.abs(t.amount), 0);
            const monthlyExpenses = transactions.filter(t => (t.type === 'Purchase' || t.type === 'Expense') && t.status === 'Completed').reduce((sum, t) => sum + Math.abs(t.amount), 0);
            const pendingPayments = receivables.reduce((sum, r) => sum + r.amount, 0);
            const netProfit = monthlyRevenue - monthlyExpenses;
            
            document.getElementById('monthlyRevenue').textContent = `₹${monthlyRevenue.toLocaleString()}`;
            document.getElementById('monthlyExpenses').textContent = `₹${monthlyExpenses.toLocaleString()}`;
            document.getElementById('pendingPayments').textContent = `₹${pendingPayments.toLocaleString()}`;
            document.getElementById('netProfit').textContent = `₹${netProfit.toLocaleString()}`;
        }

        function filterFinancials() {
            const periodFilter = document.getElementById('financialPeriodFilter').value;
            const typeFilter = document.getElementById('transactionTypeFilter').value;
            const currencyFilter = document.getElementById('currencyFilter').value;
            
            let filteredTransactions = transactions;
            
            if (typeFilter) {
                filteredTransactions = filteredTransactions.filter(t => t.type === typeFilter);
            }
            if (currencyFilter) {
                filteredTransactions = filteredTransactions.filter(t => t.currency === currencyFilter);
            }
            
            const tbody = document.getElementById('transactionTableBody');
            tbody.innerHTML = filteredTransactions.map(transaction => `
                <tr>
                    <td>${transaction.date}</td>
                    <td>${transaction.id}</td>
                    <td>${transaction.type}</td>
                    <td>${transaction.description}</td>
                    <td style="color: ${transaction.amount > 0 ? '#4CAF50' : '#F44336'}">${getCurrencySymbol(transaction.currency)}${Math.abs(transaction.amount).toLocaleString()}</td>
                    <td>${transaction.currency}</td>
                    <td>${getCurrencySymbol(transaction.currency)}${transaction.gst.toLocaleString()}</td>
                    <td><span class="status-badge ${transaction.status === 'Completed' ? 'status-delivered' : 'status-pending'}">${transaction.status}</span></td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewTransaction('${transaction.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editTransaction('${transaction.id}')">Edit</button>
                    </td>
                </tr>
            `).join('');
        }

        function getCurrencySymbol(currency) {
            switch(currency) {
                case 'USD': return '$';
                case 'EUR': return '€';
                case 'INR': return '₹';
                default: return '₹';
            }
        }

        function loadProductionTable() {
            const tbody = document.getElementById('productionTableBody');
            tbody.innerHTML = productionOrders.map(order => `
                <tr>
                    <td>${order.id}</td>
                    <td>${order.product}</td>
                    <td>${order.quantity}</td>
                    <td><span class="status-badge status-${order.status.toLowerCase().replace(/\s+/g, '')}">${order.status}</span></td>
                    <td>${order.startDate}</td>
                    <td>${order.expectedCompletion}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewProductionOrder('${order.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editProductionOrder('${order.id}')">Edit</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadLogisticsTable() {
            const tbody = document.getElementById('logisticsTableBody');
            tbody.innerHTML = deliveries.map(delivery => `
                <tr>
                    <td>${delivery.id}</td>
                    <td>${delivery.orderId}</td>
                    <td>${delivery.customer}</td>
                    <td>${delivery.vehicle}</td>
                    <td>${delivery.driver}</td>
                    <td><span class="status-badge status-${delivery.status.toLowerCase().replace(/\s+/g, '')}">${delivery.status}</span></td>
                    <td>${delivery.eta}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="trackDelivery('${delivery.id}')">Track</button>
                        <button class="btn btn-success btn-sm" onclick="updateDelivery('${delivery.id}')">Update</button>
                    </td>
                </tr>
            `).join('');
        }

        // Chart Functions
        function loadSalesChart() {
            const ctx = document.getElementById('salesChart');
            if (!ctx) return;
            // Destroy existing chart instance if it exists to prevent errors
            if (window.mySalesChart instanceof Chart) {
                window.mySalesChart.destroy();
            }
            window.mySalesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep'],
                    datasets: [{
                        label: 'Sales Revenue (₹ Lakhs)',
                        data: [45, 52, 48, 61, 55, 67, 73, 69, 75],
                        borderColor: '#2196F3',
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Enhanced Form Handlers
        function createOrder(event) {
            event.preventDefault();
            const newOrder = {
                id: `ORD-2024-${String(orders.length + 1).padStart(3, '0')}`,
                type: document.getElementById('orderType').value,
                customer: document.getElementById('orderCustomer').value,
                amount: parseFloat(document.getElementById('orderAmount').value),
                status: 'Pending',
                priority: document.getElementById('orderPriority').value,
                date: new Date().toISOString().split('T')[0],
                deliveryDate: document.getElementById('orderDeliveryDate').value,
                paymentTerms: document.getElementById('orderPaymentTerms').value,
                instructions: document.getElementById('orderInstructions').value,
                approvedBy: null,
                approvedDate: null
            };
            orders.push(newOrder);
            hideModal('newOrderModal');
            if (document.getElementById('orders').classList.contains('hidden') === false) {
                 loadOrdersTable();
            }
            alert('Order created successfully! Status: Pending Approval');
            event.target.reset();
        }

        function processReturnRefund(event) {
            event.preventDefault();
            const returnData = {
                orderId: document.getElementById('returnOrderId').value,
                returnType: document.getElementById('returnType').value,
                quantity: parseInt(document.getElementById('returnQuantity').value),
                refundAmount: parseFloat(document.getElementById('refundAmount').value),
                reason: document.getElementById('returnReason').value,
                processedBy: currentUser ? currentUser.name : 'System',
                processedDate: new Date().toISOString().split('T')[0]
            };
            
            // Update order status to returned
            const order = orders.find(o => o.id === returnData.orderId);
            if (order) {
                order.status = 'Returned';
            }
            
            hideModal('returnRefundModal');
            if (document.getElementById('orders').classList.contains('hidden') === false) {
                 loadOrdersTable();
            }
            alert(`Return processed successfully! Refund amount: ₹${returnData.refundAmount.toLocaleString()}`);
            event.target.reset();
        }

        // Order Management Functions
        function approveOrder(orderId) {
            if (confirm('Are you sure you want to approve this order?')) {
                const order = orders.find(o => o.id === orderId);
                if (order) {
                    order.status = 'Approved';
                    order.approvedBy = currentUser ? currentUser.name : 'System';
                    order.approvedDate = new Date().toISOString().split('T')[0];
                    loadOrdersTable();
                    alert('Order approved successfully!');
                }
            }
        }

        function startProduction(orderId) {
            if (confirm('Start production for this order?')) {
                const order = orders.find(o => o.id === orderId);
                if (order) {
                    order.status = 'In Production';
                    loadOrdersTable();
                    alert('Production started for order!');
                }
            }
        }

        function dispatchOrder(orderId) {
            if (confirm('Dispatch this order?')) {
                const order = orders.find(o => o.id === orderId);
                if (order) {
                    order.status = 'Dispatched';
                    loadOrdersTable();
                    alert('Order dispatched successfully!');
                }
            }
        }

        function cancelOrder(orderId) {
            if (confirm('Are you sure you want to cancel this order?')) {
                const order = orders.find(o => o.id === orderId);
                if (order) {
                    order.status = 'Cancelled';
                    loadOrdersTable();
                    alert('Order cancelled successfully!');
                }
            }
        }

        function updateOrderWorkflowStats() {
            const pendingCount = orders.filter(o => o.status === 'Pending').length;
            const inProductionCount = orders.filter(o => o.status === 'In Production').length;
            const dispatchedCount = orders.filter(o => o.status === 'Dispatched').length;
            const deliveredCount = orders.filter(o => o.status === 'Delivered').length;
            
            document.getElementById('pendingApprovalCount').textContent = pendingCount;
            document.getElementById('inProductionCount').textContent = inProductionCount;
            document.getElementById('dispatchedCount').textContent = dispatchedCount;
            document.getElementById('deliveredCount').textContent = deliveredCount;
        }

        function filterOrders() {
            const statusFilter = document.getElementById('orderStatusFilter').value;
            const typeFilter = document.getElementById('orderTypeFilter').value;
            const dateFilter = document.getElementById('orderDateFilter').value;
            
            let filteredOrders = orders;
            
            if (statusFilter) {
                filteredOrders = filteredOrders.filter(o => o.status === statusFilter);
            }
            if (typeFilter) {
                filteredOrders = filteredOrders.filter(o => o.type === typeFilter);
            }
            if (dateFilter) {
                filteredOrders = filteredOrders.filter(o => o.date === dateFilter);
            }
            
            const tbody = document.getElementById('ordersTableBody');
            tbody.innerHTML = filteredOrders.map(order => `
                <tr>
                    <td><input type="checkbox" class="order-checkbox" value="${order.id}"></td>
                    <td>${order.id}</td>
                    <td>${order.type}</td>
                    <td>${order.customer}</td>
                    <td>₹${order.amount.toLocaleString()}</td>
                    <td><span class="status-badge status-${order.status.toLowerCase().replace(/\s+/g, '')}">${order.status}</span></td>
                    <td><span class="status-badge ${order.priority === 'Urgent' ? 'status-cancelled' : order.priority === 'High' ? 'status-pending' : 'status-delivered'}">${order.priority}</span></td>
                    <td>${order.date}</td>
                    <td>${order.deliveryDate}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewOrder('${order.id}')">View</button>
                        ${order.status === 'Pending' ? `<button class="btn btn-success btn-sm" onclick="approveOrder('${order.id}')">Approve</button>` : ''}
                        ${order.status === 'Approved' ? `<button class="btn btn-success btn-sm" onclick="startProduction('${order.id}')">Start Production</button>` : ''}
                        ${order.status === 'In Production' ? `<button class="btn btn-success btn-sm" onclick="dispatchOrder('${order.id}')">Dispatch</button>` : ''}
                        <button class="btn btn-danger btn-sm" onclick="cancelOrder('${order.id}')">Cancel</button>
                    </td>
                </tr>
            `).join('');
        }

        function toggleAllOrders() {
            const selectAll = document.getElementById('selectAllOrders');
            const checkboxes = document.querySelectorAll('.order-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });
        }

        function bulkApproveOrders() {
            const selectedOrders = Array.from(document.querySelectorAll('.order-checkbox:checked')).map(cb => cb.value);
            if (selectedOrders.length === 0) {
                alert('Please select orders to approve');
                return;
            }
            
            if (confirm(`Approve ${selectedOrders.length} selected orders?`)) {
                selectedOrders.forEach(orderId => {
                    const order = orders.find(o => o.id === orderId);
                    if (order && order.status === 'Pending') {
                        order.status = 'Approved';
                        order.approvedBy = currentUser ? currentUser.name : 'System';
                        order.approvedDate = new Date().toISOString().split('T')[0];
                    }
                });
                loadOrdersTable();
                alert(`${selectedOrders.length} orders approved successfully!`);
            }
        }

        function exportOrders() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Order ID,Type,Customer,Amount,Status,Priority,Date,Delivery Date,Payment Terms\n" +
                orders.map(order => 
                    `${order.id},${order.type},${order.customer},${order.amount},${order.status},${order.priority},${order.date},${order.deliveryDate},${order.paymentTerms}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "orders_export.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Order Form Helper Functions
        function updateOrderFields() {
            const orderType = document.getElementById('orderType').value;
            const customerSelect = document.getElementById('orderCustomer');
            
            // Update customer options based on order type
            if (orderType === 'Internal' || orderType === 'Production') {
                customerSelect.innerHTML = '<option value="Internal">Internal</option>';
            } else {
                customerSelect.innerHTML = `
                    <option value="">Select Customer/Distributor</option>
                    <option value="ABC Distributors">ABC Distributors</option>
                    <option value="XYZ Retail">XYZ Retail</option>
                    <option value="Direct Customer">Direct Customer</option>
                    <option value="PQR Wholesale">PQR Wholesale</option>
                    <option value="LMN Stores">LMN Stores</option>
                `;
            }
        }

        function updateProductPrice() {
            const productSelect = document.getElementById('orderProduct');
            const selectedOption = productSelect.options[productSelect.selectedIndex];
            const price = selectedOption.getAttribute('data-price');
            document.getElementById('orderUnitPrice').value = price;
            calculateTotal();
        }

        function calculateTotal() {
            const quantity = parseFloat(document.getElementById('orderQuantity').value) || 0;
            const unitPrice = parseFloat(document.getElementById('orderUnitPrice').value) || 0;
            const total = quantity * unitPrice;
            document.getElementById('orderAmount').value = total.toFixed(2);
        }

        function loadOrderDetails() {
            const orderId = document.getElementById('returnOrderId').value;
            const order = orders.find(o => o.id === orderId);
            if (order) {
                document.getElementById('refundAmount').value = order.amount;
            }
        }

        function addProduct(event) {
            event.preventDefault();
            const newProduct = {
                name: document.getElementById('productName').value,
                sku: document.getElementById('productSKU').value,
                category: document.getElementById('productCategory').value,
                stock: parseInt(document.getElementById('productStock').value),
                minStock: parseInt(document.getElementById('productMinStock').value),
                price: parseFloat(document.getElementById('productPrice').value),
                location: document.getElementById('productLocation').value,
                reorderQty: parseInt(document.getElementById('productReorderQty').value),
                supplier: document.getElementById('productSupplier').value,
                barcode: document.getElementById('productBarcode').value,
                description: document.getElementById('productDescription').value
            };
            inventory.push(newProduct);
            hideModal('addProductModal');
            if (document.getElementById('inventory').classList.contains('hidden') === false) {
                loadInventoryGrid();
            }
            alert('Product added successfully!');
            event.target.reset();
        }

        // Enhanced Inventory Management Functions
        function lookupProductByBarcode() {
            const barcode = document.getElementById('manualBarcode').value;
            const product = inventory.find(item => item.barcode === barcode);
            const resultDiv = document.getElementById('barcodeResult');
            
            if (product) {
                resultDiv.innerHTML = `
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <h4>Product Found!</h4>
                        <p><strong>Name:</strong> ${product.name}</p>
                        <p><strong>SKU:</strong> ${product.sku}</p>
                        <p><strong>Stock:</strong> ${product.stock} units</p>
                        <p><strong>Location:</strong> ${product.location}</p>
                        <p><strong>Price:</strong> ₹${product.price}</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div style="background: #ffebee; padding: 15px; border-radius: 8px; border-left: 4px solid #f44336;">
                        <h4>Product Not Found</h4>
                        <p>No product found with barcode: ${barcode}</p>
                    </div>
                `;
            }
        }

        function processStockAdjustment(event) {
            event.preventDefault();
            const productName = document.getElementById('adjustmentProduct').value;
            const adjustmentType = document.getElementById('adjustmentType').value;
            const quantity = parseInt(document.getElementById('adjustmentQuantity').value);
            const reason = document.getElementById('adjustmentReason').value;
            
            const product = inventory.find(item => item.name === productName);
            if (product) {
                let newStock = product.stock;
                
                if (adjustmentType === 'increase') {
                    newStock += quantity;
                } else {
                    newStock -= quantity;
                }
                
                product.stock = Math.max(0, newStock);
                
                // Log the adjustment
                console.log(`Stock adjustment: ${productName} - ${adjustmentType} ${quantity} units. Reason: ${reason}`);
                
                hideModal('stockAdjustmentModal');
                if (document.getElementById('inventory').classList.contains('hidden') === false) {
                    loadInventoryGrid();
                }
                alert(`Stock adjustment processed successfully! New stock: ${product.stock} units`);
                event.target.reset();
            }
        }

        function loadProductStock() {
            const productName = document.getElementById('adjustmentProduct').value;
            const product = inventory.find(item => item.name === productName);
            if (product) {
                document.getElementById('currentStockDisplay').value = product.stock;
                document.getElementById('adjustmentQuantity').addEventListener('input', function() {
                    const adjustmentType = document.getElementById('adjustmentType').value;
                    const quantity = parseInt(this.value) || 0;
                    let newStock = product.stock;
                    
                    if (adjustmentType === 'increase') {
                        newStock += quantity;
                    } else if (adjustmentType === 'decrease' || adjustmentType === 'damaged' || adjustmentType === 'expired' || adjustmentType === 'lost') {
                        newStock -= quantity;
                    }
                    
                    document.getElementById('newStockLevel').value = Math.max(0, newStock);
                });
            }
        }

        function loadBatchData() {
            const productName = document.getElementById('batchProduct').value;
            const tbody = document.getElementById('batchTrackingTableBody');
            
            if (productName && batchData[productName]) {
                tbody.innerHTML = batchData[productName].map(batch => `
                    <tr>
                        <td>${batch.batchNumber}</td>
                        <td>${batch.quantity}</td>
                        <td>${batch.manufacturingDate}</td>
                        <td>${batch.expiryDate}</td>
                        <td><span class="status-badge status-delivered">${batch.status}</span></td>
                        <td>${batch.location}</td>
                        <td>
                            <button class="btn btn-primary btn-sm" onclick="viewBatchDetails('${batch.batchNumber}')">View</button>
                            <button class="btn btn-success btn-sm" onclick="updateBatchStatus('${batch.batchNumber}')">Update</button>
                        </td>
                    </tr>
                `).join('');
            } else {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">No batch data available for this product</td></tr>';
            }
        }

        function exportInventory() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Product Name,SKU,Category,Stock,Min Stock,Price,Location,Supplier,Barcode\n" +
                inventory.map(item => 
                    `${item.name},${item.sku},${item.category},${item.stock},${item.minStock},${item.price},${item.location},${item.supplier},${item.barcode}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "inventory_export.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function generateReorderReport() {
            const lowStockItems = inventory.filter(item => item.stock <= item.minStock);
            const reportContent = "data:text/csv;charset=utf-8," + 
                "Product Name,SKU,Current Stock,Min Stock,Reorder Quantity,Supplier,Location\n" +
                lowStockItems.map(item => 
                    `${item.name},${item.sku},${item.stock},${item.minStock},${item.reorderQty},${item.supplier},${item.location}`
                ).join("\n");
            
            const encodedUri = encodeURI(reportContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "reorder_report.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Inventory Action Functions
        function viewProduct(productName) {
            const product = inventory.find(item => item.name === productName);
            if (product) {
                alert(`Product Details:\n\nName: ${product.name}\nSKU: ${product.sku}\nCategory: ${product.category}\nStock: ${product.stock}\nMin Stock: ${product.minStock}\nPrice: ₹${product.price}\nLocation: ${product.location}\nSupplier: ${product.supplier}\nBarcode: ${product.barcode}\nDescription: ${product.description}`);
            }
        }

        function adjustStock(productName) {
            document.getElementById('adjustmentProduct').value = productName;
            loadProductStock();
            showModal('stockAdjustmentModal');
        }

        function viewBatch(productName) {
            document.getElementById('batchProduct').value = productName;
            loadBatchData();
            showModal('batchTrackingModal');
        }

        function createPurchaseOrder(productName) {
            const product = inventory.find(item => item.name === productName);
            if (product) {
                alert(`Creating Purchase Order for ${product.name}\nReorder Quantity: ${product.reorderQty}\nSupplier: ${product.supplier}\nEstimated Cost: ₹${(product.reorderQty * product.price).toLocaleString()}`);
            }
        }

        function reorderProduct(productName) {
            const product = inventory.find(item => item.name === productName);
            if (product) {
                if (confirm(`Reorder ${product.reorderQty} units of ${product.name} from ${product.supplier}?`)) {
                    product.stock += product.reorderQty;
                    loadInventoryGrid();
                    alert(`Reorder processed! New stock: ${product.stock} units`);
                }
            }
        }

        function viewBatchDetails(batchNumber) {
            alert(`Batch Details for ${batchNumber}\n\nThis would show detailed batch information including:\n- Manufacturing details\n- Quality control data\n- Storage conditions\n- Movement history`);
        }

        function updateBatchStatus(batchNumber) {
            alert(`Update batch status for ${batchNumber}\n\nThis would allow updating:\n- Batch status\n- Location\n- Quality status\n- Expiry information`);
        }

        function addStaff(event) {
            event.preventDefault();
            const newStaff = {
                id: document.getElementById('staffId').value,
                name: document.getElementById('staffName').value,
                role: document.getElementById('staffRole').value,
                department: document.getElementById('staffDepartment').value,
                status: 'Present',
                email: document.getElementById('staffEmail').value,
                phone: document.getElementById('staffPhone').value,
                shift: document.getElementById('staffShift').value,
                salary: parseFloat(document.getElementById('staffSalary').value),
                biometricId: document.getElementById('staffBiometricId').value,
                joiningDate: document.getElementById('staffJoiningDate').value,
                checkinTime: null,
                checkoutTime: null,
                productivityScore: 85, // Default productivity score
                attendanceRate: 100 // Default attendance rate for new employees
            };
            staff.push(newStaff);
            
            // Add to attendance data
            attendanceData.push({
                employeeId: newStaff.id,
                employeeName: newStaff.name,
                checkinTime: null,
                checkoutTime: null,
                hoursWorked: 0,
                overtime: 0,
                status: 'Present'
            });
            
            hideModal('addStaffModal');
            if (document.getElementById('staff').classList.contains('hidden') === false) {
                loadStaffTable();
            }
            alert('Staff member added successfully!');
            event.target.reset();
        }

        // Enhanced Staff Management Functions
        function lookupEmployee() {
            const employeeId = document.getElementById('manualEmployeeId').value;
            const employee = staff.find(member => member.id === employeeId);
            const resultDiv = document.getElementById('employeeLookupResult');
            
            if (employee) {
                resultDiv.innerHTML = `
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <h4>Employee Found!</h4>
                        <p><strong>Name:</strong> ${employee.name}</p>
                        <p><strong>Department:</strong> ${employee.department}</p>
                        <p><strong>Shift:</strong> ${employee.shift}</p>
                        <p><strong>Status:</strong> ${employee.status}</p>
                        <p><strong>Check-in Time:</strong> ${employee.checkinTime || 'Not checked in'}</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div style="background: #ffebee; padding: 15px; border-radius: 8px; border-left: 4px solid #f44336;">
                        <h4>Employee Not Found</h4>
                        <p>No employee found with ID: ${employeeId}</p>
                    </div>
                `;
            }
        }

        function processCheckin() {
            const employeeId = document.getElementById('manualEmployeeId').value;
            const employee = staff.find(member => member.id === employeeId);
            
            if (employee) {
                const currentTime = new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });
                employee.checkinTime = currentTime;
                employee.status = 'Present';
                
                // Update attendance data
                const attendance = attendanceData.find(att => att.employeeId === employeeId);
                if (attendance) {
                    attendance.checkinTime = currentTime;
                    attendance.status = 'Present';
                }
                
                loadStaffTable();
                alert(`${employee.name} checked in successfully at ${currentTime}`);
                document.getElementById('manualEmployeeId').value = '';
                document.getElementById('employeeLookupResult').innerHTML = '';
            } else {
                alert('Please enter a valid Employee ID');
            }
        }

        function processCheckout() {
            const employeeId = document.getElementById('manualEmployeeId').value;
            const employee = staff.find(member => member.id === employeeId);
            
            if (employee && employee.checkinTime) {
                const currentTime = new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });
                employee.checkoutTime = currentTime;
                
                // Calculate hours worked
                const checkinTime = new Date(`2000-01-01T${employee.checkinTime}:00`);
                const checkoutTime = new Date(`2000-01-01T${currentTime}:00`);
                const hoursWorked = (checkoutTime - checkinTime) / (1000 * 60 * 60);
                
                // Update attendance data
                const attendance = attendanceData.find(att => att.employeeId === employeeId);
                if (attendance) {
                    attendance.checkoutTime = currentTime;
                    attendance.hoursWorked = Math.round(hoursWorked * 10) / 10;
                    attendance.overtime = Math.max(0, hoursWorked - 8);
                }
                
                loadStaffTable();
                alert(`${employee.name} checked out successfully at ${currentTime}. Hours worked: ${Math.round(hoursWorked * 10) / 10}`);
                document.getElementById('manualEmployeeId').value = '';
                document.getElementById('employeeLookupResult').innerHTML = '';
            } else {
                alert('Employee must check in first before checking out');
            }
        }

        function loadShiftSchedule() {
            const selectedDate = document.getElementById('scheduleDate').value;
            const tbody = document.getElementById('shiftScheduleTableBody');
            
            if (selectedDate) {
                tbody.innerHTML = staff.map(member => `
                    <tr>
                        <td>${member.name}</td>
                        <td>${member.department}</td>
                        <td>${member.shift}</td>
                        <td>${member.shift}</td>
                        <td><span class="status-badge ${member.status === 'Present' ? 'status-delivered' : 'status-cancelled'}">${member.status}</span></td>
                        <td>
                            <button class="btn btn-primary btn-sm" onclick="changeShift('${member.id}')">Change Shift</button>
                        </td>
                    </tr>
                `).join('');
            }
        }

        function generatePerformanceReport() {
            const period = document.getElementById('performancePeriod').value;
            const startDate = document.getElementById('performanceStartDate').value;
            const endDate = document.getElementById('performanceEndDate').value;
            
            const tbody = document.getElementById('performanceReportTableBody');
            tbody.innerHTML = staff.map(member => {
                const tasksCompleted = Math.floor(Math.random() * 20) + 10; // Random for demo
                const hoursWorked = Math.floor(Math.random() * 40) + 160; // Random for demo
                const rating = member.productivityScore > 95 ? 'Excellent' : member.productivityScore > 85 ? 'Good' : 'Average';
                
                return `
                    <tr>
                        <td>${member.name}</td>
                        <td>${member.department}</td>
                        <td>${tasksCompleted}</td>
                        <td>${hoursWorked}</td>
                        <td>${member.productivityScore}%</td>
                        <td>${member.attendanceRate}%</td>
                        <td><span class="status-badge ${rating === 'Excellent' ? 'status-delivered' : rating === 'Good' ? 'status-pending' : 'status-cancelled'}">${rating}</span></td>
                    </tr>
                `;
            }).join('');
        }

        function exportStaff() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Employee ID,Name,Role,Department,Shift,Status,Check-in Time,Productivity Score,Attendance Rate,Salary\n" +
                staff.map(member => 
                    `${member.id},${member.name},${member.role},${member.department},${member.shift},${member.status},${member.checkinTime || 'Not checked in'},${member.productivityScore},${member.attendanceRate},${member.salary}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "staff_export.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function generatePayroll() {
            const totalPayroll = staff.reduce((sum, member) => sum + member.salary, 0);
            const presentStaff = staff.filter(member => member.status === 'Present');
            const presentPayroll = presentStaff.reduce((sum, member) => sum + member.salary, 0);
            
            alert(`Payroll Summary:\n\nTotal Staff: ${staff.length}\nPresent Today: ${presentStaff.length}\nTotal Monthly Payroll: ₹${totalPayroll.toLocaleString()}\nPresent Staff Payroll: ₹${presentPayroll.toLocaleString()}\n\nPayroll report generated successfully!`);
        }

        // Staff Action Functions
        function viewStaff(staffId) {
            const member = staff.find(s => s.id === staffId);
            if (member) {
                alert(`Staff Details:\n\nName: ${member.name}\nEmployee ID: ${member.id}\nRole: ${member.role}\nDepartment: ${member.department}\nShift: ${member.shift}\nStatus: ${member.status}\nEmail: ${member.email}\nPhone: ${member.phone}\nSalary: ₹${member.salary.toLocaleString()}\nBiometric ID: ${member.biometricId}\nJoining Date: ${member.joiningDate}\nProductivity Score: ${member.productivityScore}%\nAttendance Rate: ${member.attendanceRate}%`);
            }
        }

        function editStaff(staffId) {
            alert(`Edit staff member: ${staffId}\n\nThis would open an edit form with all staff details`);
        }

        function viewAttendance(staffId) {
            const member = staff.find(s => s.id === staffId);
            const attendance = attendanceData.find(att => att.employeeId === staffId);
            
            if (member && attendance) {
                alert(`Attendance Details for ${member.name}:\n\nCheck-in Time: ${attendance.checkinTime || 'Not checked in'}\nCheck-out Time: ${attendance.checkoutTime || 'Not checked out'}\nHours Worked: ${attendance.hoursWorked}\nOvertime: ${attendance.overtime}\nStatus: ${attendance.status}`);
            }
        }

        function manageAttendance(employeeId) {
            alert(`Manage attendance for employee: ${employeeId}\n\nThis would allow:\n- Manual check-in/check-out\n- Leave management\n- Attendance corrections`);
        }

        function changeShift(employeeId) {
            const member = staff.find(s => s.id === employeeId);
            if (member) {
                const newShift = prompt(`Change shift for ${member.name}\nCurrent shift: ${member.shift}\nEnter new shift:`, member.shift);
                if (newShift && newShift !== member.shift) {
                    member.shift = newShift;
                    loadShiftSchedule();
                    alert(`Shift changed successfully for ${member.name}`);
                }
            }
        }

        // Action Functions (placeholders)
        function viewOrder(orderId) { alert(`Viewing order: ${orderId}`); }
        function editOrder(orderId) { alert(`Editing order: ${orderId}`); }
        function viewStaff(staffId) { alert(`Viewing staff: ${staffId}`); }
        function editStaff(staffId) { alert(`Editing staff: ${staffId}`); }
        function viewCustomer(customerId) { alert(`Viewing customer: ${customerId}`); }
        function editCustomer(customerId) { alert(`Editing customer: ${customerId}`); }
        // Invoice Management Functions
        function createInvoice(event) {
            event.preventDefault();
            const invoiceNumber = document.getElementById('invoiceNumber').value || `INV${String(Date.now()).slice(-6)}`;
            const invoiceDate = document.getElementById('invoiceDate').value;
            const customer = document.getElementById('invoiceCustomer').value;
            const currency = document.getElementById('invoiceCurrency').value;
            
            // Calculate totals
            const items = document.querySelectorAll('.invoice-item');
            let subtotal = 0;
            let totalGST = 0;
            
            items.forEach(item => {
                const qty = parseFloat(item.querySelector('input[placeholder="Qty"]').value) || 0;
                const rate = parseFloat(item.querySelector('input[placeholder="Rate"]').value) || 0;
                const gstRate = parseFloat(item.querySelector('input[placeholder="GST%"]').value) || 0;
                const itemTotal = qty * rate;
                const gstAmount = (itemTotal * gstRate) / 100;
                subtotal += itemTotal;
                totalGST += gstAmount;
            });
            
            const totalAmount = subtotal + totalGST;
            
            // Create invoice transaction
            const invoiceTransaction = {
                id: invoiceNumber,
                date: invoiceDate,
                type: 'Sale',
                amount: totalAmount,
                currency: currency,
                gst: totalGST,
                description: `Invoice ${invoiceNumber} - ${customer}`,
                status: 'Completed'
            };
            
            transactions.unshift(invoiceTransaction);
            loadTransactionTable();
            hideModal('createInvoiceModal');
            
            alert(`Invoice ${invoiceNumber} created successfully!\nTotal Amount: ${getCurrencySymbol(currency)}${totalAmount.toLocaleString()}`);
        }

        function loadCustomerDetails() {
            const customer = document.getElementById('invoiceCustomer').value;
            const detailsDiv = document.getElementById('customerDetails');
            
            if (customer) {
                detailsDiv.innerHTML = `
                    <h4>${customer}</h4>
                    <p><strong>Address:</strong> 123 Business Street, Mumbai, Maharashtra - 400001</p>
                    <p><strong>GST Number:</strong> 27ABCDE1234F1Z5</p>
                    <p><strong>Contact:</strong> +91-9876543210</p>
                    <p><strong>Email:</strong> ${customer.toLowerCase().replace(/\s+/g, '')}@example.com</p>
                `;
            } else {
                detailsDiv.innerHTML = '<p>Select a customer to view details</p>';
            }
        }

        function updateItemPrice(selectElement) {
            const price = selectElement.options[selectElement.selectedIndex].getAttribute('data-price');
            const rateInput = selectElement.parentElement.querySelector('input[placeholder="Rate"]');
            if (price) {
                rateInput.value = price;
                calculateItemTotal(rateInput);
            }
        }

        function calculateItemTotal(inputElement) {
            const itemDiv = inputElement.closest('.invoice-item');
            const qtyInput = itemDiv.querySelector('input[placeholder="Qty"]');
            const rateInput = itemDiv.querySelector('input[placeholder="Rate"]');
            const gstInput = itemDiv.querySelector('input[placeholder="GST%"]');
            const totalInput = itemDiv.querySelector('input[placeholder="Total"]');
            
            const qty = parseFloat(qtyInput.value) || 0;
            const rate = parseFloat(rateInput.value) || 0;
            const gstRate = parseFloat(gstInput.value) || 0;
            
            const subtotal = qty * rate;
            const gstAmount = (subtotal * gstRate) / 100;
            const total = subtotal + gstAmount;
            
            totalInput.value = total.toFixed(2);
        }

        function addInvoiceItem() {
            const itemsContainer = document.getElementById('invoiceItems');
            const newItem = document.createElement('div');
            newItem.className = 'invoice-item';
            newItem.style.cssText = 'display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr auto; gap: 10px; align-items: center; margin-bottom: 10px;';
            newItem.innerHTML = `
                <select class="form-input" onchange="updateItemPrice(this)">
                    <option value="">Select Item</option>
                    <option value="Product X" data-price="155.00">Product X</option>
                    <option value="Product Y" data-price="225.00">Product Y</option>
                    <option value="Raw Material A" data-price="25.50">Raw Material A</option>
                </select>
                <input type="number" class="form-input" placeholder="Qty" onchange="calculateItemTotal(this)">
                <input type="number" step="0.01" class="form-input" placeholder="Rate" readonly>
                <input type="number" step="0.01" class="form-input" placeholder="GST%" value="18">
                <input type="number" step="0.01" class="form-input" placeholder="Total" readonly>
                <button type="button" class="btn btn-danger btn-sm" onclick="removeInvoiceItem(this)">Remove</button>
            `;
            itemsContainer.appendChild(newItem);
        }

        function removeInvoiceItem(button) {
            button.closest('.invoice-item').remove();
        }

        function previewInvoice() {
            alert('Invoice preview functionality would be implemented here with PDF generation');
        }

        function viewTransaction(transactionId) { 
            const transaction = transactions.find(t => t.id === transactionId);
            if (transaction) {
                alert(`Transaction Details:\nID: ${transaction.id}\nDate: ${transaction.date}\nType: ${transaction.type}\nAmount: ${getCurrencySymbol(transaction.currency)}${Math.abs(transaction.amount).toLocaleString()}\nGST: ${getCurrencySymbol(transaction.currency)}${transaction.gst.toLocaleString()}\nDescription: ${transaction.description}\nStatus: ${transaction.status}`);
            }
        }
        // Payment Gateway Functions
        function processPayment(event) {
            event.preventDefault();
            const invoiceId = document.getElementById('paymentInvoiceId').value;
            const amount = parseFloat(document.getElementById('paymentAmount').value);
            const currency = document.getElementById('paymentCurrency').value;
            const method = document.getElementById('paymentMethod').value;
            const reference = document.getElementById('paymentReference').value;
            
            // Simulate payment processing
            const paymentTransaction = {
                id: `PAY${String(Date.now()).slice(-6)}`,
                date: new Date().toISOString().split('T')[0],
                type: 'Payment',
                amount: amount,
                currency: currency,
                gst: 0,
                description: `Payment for ${invoiceId} via ${method}`,
                status: 'Completed'
            };
            
            transactions.unshift(paymentTransaction);
            loadTransactionTable();
            hideModal('paymentGatewayModal');
            
            alert(`Payment processed successfully!\nReference: ${reference}\nAmount: ${getCurrencySymbol(currency)}${amount.toLocaleString()}`);
        }

        function updatePaymentFields() {
            const method = document.getElementById('paymentMethod').value;
            const fieldsDiv = document.getElementById('paymentFields');
            
            if (method === 'card') {
                fieldsDiv.style.display = 'block';
            } else {
                fieldsDiv.style.display = 'none';
            }
        }

        // GST Settings Functions
        function saveGSTSettings(event) {
            event.preventDefault();
            gstSettings.gstNumber = document.getElementById('gstNumber').value;
            gstSettings.cgstRate = parseFloat(document.getElementById('cgstRate').value);
            gstSettings.sgstRate = parseFloat(document.getElementById('sgstRate').value);
            gstSettings.igstRate = parseFloat(document.getElementById('igstRate').value);
            gstSettings.businessAddress = document.getElementById('businessAddress').value;
            
            hideModal('gstSettingsModal');
            alert('GST settings saved successfully!');
        }

        // Currency Settings Functions
        function saveCurrencySettings(event) {
            event.preventDefault();
            currencySettings.baseCurrency = document.getElementById('baseCurrency').value;
            currencySettings.exchangeRates.USD = parseFloat(document.getElementById('usdRate').value);
            currencySettings.exchangeRates.EUR = parseFloat(document.getElementById('eurRate').value);
            currencySettings.autoUpdate = document.getElementById('autoUpdateRates').checked;
            
            hideModal('currencySettingsModal');
            alert('Currency settings saved successfully!');
        }

        function updateCurrencyRate() {
            const currency = document.getElementById('invoiceCurrency').value;
            alert(`Exchange rate updated for ${currency}`);
        }

        // Tax Report Functions
        function generateTaxReport() {
            const reportData = [
                { period: 'September 2024', sales: 4567890, cgst: 456789, sgst: 456789, igst: 234567, totalGST: 1148145, netAmount: 3419745 },
                { period: 'August 2024', sales: 4234567, cgst: 423457, sgst: 423457, igst: 216789, totalGST: 1063703, netAmount: 3170864 },
                { period: 'July 2024', sales: 3890123, cgst: 389012, sgst: 389012, igst: 198901, totalGST: 976925, netAmount: 2913198 }
            ];
            
            const tbody = document.getElementById('taxReportTableBody');
            tbody.innerHTML = reportData.map(row => `
                <tr>
                    <td>${row.period}</td>
                    <td>₹${row.sales.toLocaleString()}</td>
                    <td>₹${row.cgst.toLocaleString()}</td>
                    <td>₹${row.sgst.toLocaleString()}</td>
                    <td>₹${row.igst.toLocaleString()}</td>
                    <td>₹${row.totalGST.toLocaleString()}</td>
                    <td>₹${row.netAmount.toLocaleString()}</td>
                </tr>
            `).join('');
        }

        // Enhanced Transaction Functions
        function addTransaction(event) {
            event.preventDefault();
            const type = document.getElementById('transactionType').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value);
            const currency = document.getElementById('transactionCurrency').value;
            const gst = parseFloat(document.getElementById('transactionGST').value) || 0;
            const description = document.getElementById('transactionDescription').value;
            
            const newTransaction = {
                id: `TXN${String(transactions.length + 1).padStart(3, '0')}`,
                date: new Date().toISOString().split('T')[0],
                type: type,
                amount: type === 'Purchase' || type === 'Expense' ? -amount : amount,
                currency: currency,
                gst: gst,
                description: description,
                status: 'Completed'
            };
            
            transactions.unshift(newTransaction);
            loadTransactionTable();
            hideModal('addTransactionModal');
            
            // Reset form
            document.getElementById('transactionType').value = '';
            document.getElementById('transactionAmount').value = '';
            document.getElementById('transactionCurrency').value = 'INR';
            document.getElementById('transactionGST').value = '';
            document.getElementById('transactionDescription').value = '';
        }

        function exportFinancials() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Date,Transaction ID,Type,Description,Amount,Currency,GST,Status\n" +
                transactions.map(t => `${t.date},${t.id},${t.type},${t.description},${t.amount},${t.currency},${t.gst},${t.status}`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "financial_transactions.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function editTransaction(id) {
            alert(`Edit transaction ${id} functionality would be implemented here`);
        }

        // Supplier Management Functions
        function loadSupplierTable() {
            const tbody = document.getElementById('supplierTableBody');
            tbody.innerHTML = suppliers.map(supplier => `
                <tr>
                    <td>${supplier.id}</td>
                    <td>${supplier.companyName}</td>
                    <td>${supplier.contactPerson}</td>
                    <td>${supplier.category}</td>
                    <td>${'★'.repeat(Math.floor(supplier.rating))} ${supplier.rating}</td>
                    <td><span class="status-badge ${getSupplierStatusClass(supplier.status)}">${supplier.status}</span></td>
                    <td>${supplier.lastOrder}</td>
                    <td>₹${supplier.totalValue.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewSupplier('${supplier.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editSupplier('${supplier.id}')">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="rateSupplier('${supplier.id}')">Rate</button>
                    </td>
                </tr>
            `).join('');
            
            loadPurchaseOrderTable();
            loadSettlementTable();
            loadContractTable();
            updateSupplierStats();
        }

        function loadPurchaseOrderTable() {
            const tbody = document.getElementById('purchaseOrderTableBody');
            tbody.innerHTML = purchaseOrders.map(po => `
                <tr>
                    <td>${po.poNumber}</td>
                    <td>${po.supplier}</td>
                    <td>${po.date}</td>
                    <td>${po.items}</td>
                    <td>₹${po.amount.toLocaleString()}</td>
                    <td><span class="status-badge ${getPOStatusClass(po.status)}">${po.status}</span></td>
                    <td>${po.expectedDelivery}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewPurchaseOrder('${po.poNumber}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editPurchaseOrder('${po.poNumber}')">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="trackPurchaseOrder('${po.poNumber}')">Track</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadSettlementTable() {
            const tbody = document.getElementById('settlementTableBody');
            tbody.innerHTML = settlements.map(settlement => `
                <tr>
                    <td>${settlement.supplier}</td>
                    <td>${settlement.invoiceNumber}</td>
                    <td>₹${settlement.amount.toLocaleString()}</td>
                    <td>${settlement.dueDate}</td>
                    <td><span class="status-badge ${getSettlementStatusClass(settlement.status)}">${settlement.status}</span></td>
                    <td>${settlement.paymentMethod}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewSettlement('${settlement.invoiceNumber}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="processSettlement('${settlement.invoiceNumber}')">Pay</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadContractTable() {
            const tbody = document.getElementById('contractTableBody');
            tbody.innerHTML = contracts.map(contract => `
                <tr>
                    <td>${contract.contractId}</td>
                    <td>${contract.supplier}</td>
                    <td>${contract.type}</td>
                    <td>${contract.startDate}</td>
                    <td>${contract.endDate}</td>
                    <td>₹${contract.value.toLocaleString()}</td>
                    <td><span class="status-badge ${getContractStatusClass(contract.status)}">${contract.status}</span></td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewContract('${contract.contractId}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editContract('${contract.contractId}')">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="renewContract('${contract.contractId}')">Renew</button>
                    </td>
                </tr>
            `).join('');
        }

        function updateSupplierStats() {
            const totalSuppliers = suppliers.length;
            const activeSuppliers = suppliers.filter(s => s.status === 'Active' || s.status === 'Preferred').length;
            const pendingPOs = purchaseOrders.filter(po => po.status === 'Pending').length;
            const totalPurchaseValue = purchaseOrders.reduce((sum, po) => sum + po.amount, 0);
            
            document.getElementById('totalSuppliersCount').textContent = totalSuppliers;
            document.getElementById('activeSuppliersCount').textContent = activeSuppliers;
            document.getElementById('pendingPOsCount').textContent = pendingPOs;
            document.getElementById('totalPurchaseValue').textContent = `₹${totalPurchaseValue.toLocaleString()}`;
        }

        function filterSuppliers() {
            const categoryFilter = document.getElementById('supplierCategoryFilter').value;
            const statusFilter = document.getElementById('supplierStatusFilter').value;
            const ratingFilter = document.getElementById('supplierRatingFilter').value;
            
            let filteredSuppliers = suppliers;
            
            if (categoryFilter) {
                filteredSuppliers = filteredSuppliers.filter(s => s.category === categoryFilter);
            }
            if (statusFilter) {
                filteredSuppliers = filteredSuppliers.filter(s => s.status === statusFilter);
            }
            if (ratingFilter) {
                filteredSuppliers = filteredSuppliers.filter(s => Math.floor(s.rating) >= parseInt(ratingFilter));
            }
            
            const tbody = document.getElementById('supplierTableBody');
            tbody.innerHTML = filteredSuppliers.map(supplier => `
                <tr>
                    <td>${supplier.id}</td>
                    <td>${supplier.companyName}</td>
                    <td>${supplier.contactPerson}</td>
                    <td>${supplier.category}</td>
                    <td>${'★'.repeat(Math.floor(supplier.rating))} ${supplier.rating}</td>
                    <td><span class="status-badge ${getSupplierStatusClass(supplier.status)}">${supplier.status}</span></td>
                    <td>${supplier.lastOrder}</td>
                    <td>₹${supplier.totalValue.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-primary btn-sm" onclick="viewSupplier('${supplier.id}')">View</button>
                        <button class="btn btn-success btn-sm" onclick="editSupplier('${supplier.id}')">Edit</button>
                        <button class="btn btn-primary btn-sm" onclick="rateSupplier('${supplier.id}')">Rate</button>
                    </td>
                </tr>
            `).join('');
        }

        // Supplier Modal Functions
        function addSupplier(event) {
            event.preventDefault();
            const supplierId = `SUP${String(suppliers.length + 1).padStart(3, '0')}`;
            
            const newSupplier = {
                id: supplierId,
                companyName: document.getElementById('supplierCompanyName').value,
                contactPerson: document.getElementById('supplierContactPerson').value,
                designation: document.getElementById('supplierDesignation').value,
                email: document.getElementById('supplierEmail').value,
                phone: document.getElementById('supplierPhone').value,
                category: document.getElementById('supplierCategory').value,
                status: document.getElementById('supplierStatus').value,
                rating: 0,
                address: document.getElementById('supplierAddress').value,
                gst: document.getElementById('supplierGST').value,
                pan: document.getElementById('supplierPAN').value,
                lastOrder: 'N/A',
                totalValue: 0
            };
            
            suppliers.unshift(newSupplier);
            loadSupplierTable();
            hideModal('addSupplierModal');
            
            // Reset form
            document.getElementById('supplierCompanyName').value = '';
            document.getElementById('supplierContactPerson').value = '';
            document.getElementById('supplierDesignation').value = '';
            document.getElementById('supplierEmail').value = '';
            document.getElementById('supplierPhone').value = '';
            document.getElementById('supplierCategory').value = '';
            document.getElementById('supplierStatus').value = 'Active';
            document.getElementById('supplierAddress').value = '';
            document.getElementById('supplierGST').value = '';
            document.getElementById('supplierPAN').value = '';
        }

        function createPurchaseOrder(event) {
            event.preventDefault();
            const poNumber = `PO${String(purchaseOrders.length + 1).padStart(3, '0')}`;
            
            // Calculate total amount
            const items = document.querySelectorAll('.po-item');
            let totalAmount = 0;
            let itemCount = 0;
            
            items.forEach(item => {
                const qty = parseFloat(item.querySelector('input[placeholder="Qty"]').value) || 0;
                const rate = parseFloat(item.querySelector('input[placeholder="Rate"]').value) || 0;
                const itemTotal = qty * rate;
                totalAmount += itemTotal;
                if (qty > 0) itemCount++;
            });
            
            const newPO = {
                poNumber: poNumber,
                supplier: document.getElementById('poSupplier').value,
                date: document.getElementById('poDate').value,
                items: itemCount,
                amount: totalAmount,
                status: 'Pending',
                expectedDelivery: document.getElementById('poExpectedDelivery').value,
                priority: document.getElementById('poPriority').value
            };
            
            purchaseOrders.unshift(newPO);
            loadPurchaseOrderTable();
            hideModal('createPurchaseOrderModal');
            
            alert(`Purchase Order ${poNumber} created successfully!\nTotal Amount: ₹${totalAmount.toLocaleString()}`);
        }

        function processSupplierSettlement(event) {
            event.preventDefault();
            const supplier = document.getElementById('settlementSupplier').value;
            const invoiceNumber = document.getElementById('settlementInvoiceNumber').value;
            const amount = parseFloat(document.getElementById('settlementAmount').value);
            const dueDate = document.getElementById('settlementDueDate').value;
            const paymentMethod = document.getElementById('settlementPaymentMethod').value;
            const reference = document.getElementById('settlementReference').value;
            
            const newSettlement = {
                supplier: supplier,
                invoiceNumber: invoiceNumber,
                amount: amount,
                dueDate: dueDate,
                status: 'Paid',
                paymentMethod: paymentMethod
            };
            
            settlements.unshift(newSettlement);
            loadSettlementTable();
            hideModal('supplierSettlementModal');
            
            alert(`Settlement processed successfully!\nReference: ${reference}\nAmount: ₹${amount.toLocaleString()}`);
        }

        function addContract(event) {
            event.preventDefault();
            const contractId = `CON${String(contracts.length + 1).padStart(3, '0')}`;
            
            const newContract = {
                contractId: contractId,
                supplier: document.getElementById('contractSupplier').value,
                type: document.getElementById('contractType').value,
                startDate: document.getElementById('contractStartDate').value,
                endDate: document.getElementById('contractEndDate').value,
                value: parseFloat(document.getElementById('contractValue').value),
                status: 'Active'
            };
            
            contracts.unshift(newContract);
            loadContractTable();
            hideModal('addContractModal');
            
            alert(`Contract ${contractId} added successfully!`);
        }

        // Helper Functions
        function getSupplierStatusClass(status) {
            switch(status) {
                case 'Active': return 'status-delivered';
                case 'Preferred': return 'status-delivered';
                case 'Inactive': return 'status-pending';
                case 'Blacklisted': return 'status-cancelled';
                default: return 'status-pending';
            }
        }

        function getPOStatusClass(status) {
            switch(status) {
                case 'Completed': return 'status-delivered';
                case 'In Transit': return 'status-pending';
                case 'Pending': return 'status-pending';
                case 'Overdue': return 'status-cancelled';
                default: return 'status-pending';
            }
        }

        function getSettlementStatusClass(status) {
            switch(status) {
                case 'Paid': return 'status-delivered';
                case 'Pending': return 'status-pending';
                case 'Overdue': return 'status-cancelled';
                default: return 'status-pending';
            }
        }

        function getContractStatusClass(status) {
            switch(status) {
                case 'Active': return 'status-delivered';
                case 'Expired': return 'status-cancelled';
                case 'Pending': return 'status-pending';
                default: return 'status-pending';
            }
        }

        function loadSupplierDetails() {
            const supplier = document.getElementById('poSupplier').value;
            const detailsDiv = document.getElementById('supplierDetails');
            
            if (supplier) {
                const supplierData = suppliers.find(s => s.companyName === supplier);
                if (supplierData) {
                    detailsDiv.innerHTML = `
                        <h4>${supplierData.companyName}</h4>
                        <p><strong>Contact:</strong> ${supplierData.contactPerson} (${supplierData.designation})</p>
                        <p><strong>Phone:</strong> ${supplierData.phone}</p>
                        <p><strong>Email:</strong> ${supplierData.email}</p>
                        <p><strong>Address:</strong> ${supplierData.address}</p>
                        <p><strong>GST:</strong> ${supplierData.gst}</p>
                    `;
                }
            } else {
                detailsDiv.innerHTML = '<p>Select a supplier to view details</p>';
            }
        }

        function calculatePOItemTotal(inputElement) {
            const itemDiv = inputElement.closest('.po-item');
            const qtyInput = itemDiv.querySelector('input[placeholder="Qty"]');
            const rateInput = itemDiv.querySelector('input[placeholder="Rate"]');
            const totalInput = itemDiv.querySelector('input[placeholder="Total"]');
            
            const qty = parseFloat(qtyInput.value) || 0;
            const rate = parseFloat(rateInput.value) || 0;
            const total = qty * rate;
            
            totalInput.value = total.toFixed(2);
        }

        function addPOItem() {
            const itemsContainer = document.getElementById('poItems');
            const newItem = document.createElement('div');
            newItem.className = 'po-item';
            newItem.style.cssText = 'display: grid; grid-template-columns: 2fr 1fr 1fr 1fr auto; gap: 10px; align-items: center; margin-bottom: 10px;';
            newItem.innerHTML = `
                <input type="text" class="form-input" placeholder="Item Description">
                <input type="number" class="form-input" placeholder="Qty" onchange="calculatePOItemTotal(this)">
                <input type="number" step="0.01" class="form-input" placeholder="Rate">
                <input type="number" step="0.01" class="form-input" placeholder="Total" readonly>
                <button type="button" class="btn btn-danger btn-sm" onclick="removePOItem(this)">Remove</button>
            `;
            itemsContainer.appendChild(newItem);
        }

        function removePOItem(button) {
            button.closest('.po-item').remove();
        }

        function previewPurchaseOrder() {
            alert('Purchase Order preview functionality would be implemented here with PDF generation');
        }

        function exportSuppliers() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Supplier ID,Company Name,Contact Person,Category,Rating,Status,Last Order,Total Value\n" +
                suppliers.map(s => `${s.id},${s.companyName},${s.contactPerson},${s.category},${s.rating},${s.status},${s.lastOrder},${s.totalValue}`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "suppliers.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function exportPurchaseOrders() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "PO Number,Supplier,Date,Items,Amount,Status,Expected Delivery\n" +
                purchaseOrders.map(po => `${po.poNumber},${po.supplier},${po.date},${po.items},${po.amount},${po.status},${po.expectedDelivery}`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "purchase_orders.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Action Functions
        function viewSupplier(id) {
            const supplier = suppliers.find(s => s.id === id);
            if (supplier) {
                alert(`Supplier Details:\nID: ${supplier.id}\nCompany: ${supplier.companyName}\nContact: ${supplier.contactPerson}\nEmail: ${supplier.email}\nPhone: ${supplier.phone}\nCategory: ${supplier.category}\nStatus: ${supplier.status}\nRating: ${supplier.rating}\nTotal Value: ₹${supplier.totalValue.toLocaleString()}`);
            }
        }

        function editSupplier(id) {
            alert(`Edit supplier ${id} functionality would be implemented here`);
        }

        function rateSupplier(id) {
            const rating = prompt('Enter rating (1-5):');
            if (rating && rating >= 1 && rating <= 5) {
                const supplier = suppliers.find(s => s.id === id);
                if (supplier) {
                    supplier.rating = parseFloat(rating);
                    loadSupplierTable();
                    alert(`Rating updated for ${supplier.companyName}: ${rating} stars`);
                }
            }
        }

        function viewPurchaseOrder(poNumber) {
            const po = purchaseOrders.find(p => p.poNumber === poNumber);
            if (po) {
                alert(`Purchase Order Details:\nPO Number: ${po.poNumber}\nSupplier: ${po.supplier}\nDate: ${po.date}\nItems: ${po.items}\nAmount: ₹${po.amount.toLocaleString()}\nStatus: ${po.status}\nExpected Delivery: ${po.expectedDelivery}\nPriority: ${po.priority}`);
            }
        }

        function editPurchaseOrder(poNumber) {
            alert(`Edit purchase order ${poNumber} functionality would be implemented here`);
        }

        function trackPurchaseOrder(poNumber) {
            alert(`Track purchase order ${poNumber} functionality would be implemented here`);
        }

        function viewSettlement(invoiceNumber) {
            const settlement = settlements.find(s => s.invoiceNumber === invoiceNumber);
            if (settlement) {
                alert(`Settlement Details:\nInvoice: ${settlement.invoiceNumber}\nSupplier: ${settlement.supplier}\nAmount: ₹${settlement.amount.toLocaleString()}\nDue Date: ${settlement.dueDate}\nStatus: ${settlement.status}\nPayment Method: ${settlement.paymentMethod}`);
            }
        }

        function processSettlement(invoiceNumber) {
            alert(`Process settlement for ${invoiceNumber} functionality would be implemented here`);
        }

        function viewContract(contractId) {
            const contract = contracts.find(c => c.contractId === contractId);
            if (contract) {
                alert(`Contract Details:\nContract ID: ${contract.contractId}\nSupplier: ${contract.supplier}\nType: ${contract.type}\nStart Date: ${contract.startDate}\nEnd Date: ${contract.endDate}\nValue: ₹${contract.value.toLocaleString()}\nStatus: ${contract.status}`);
            }
        }

        function editContract(contractId) {
            alert(`Edit contract ${contractId} functionality would be implemented here`);
        }

        function renewContract(contractId) {
            alert(`Renew contract ${contractId} functionality would be implemented here`);
        }

        function viewProductionOrder(orderId) { alert(`Viewing production order: ${orderId}`); }
        function editProductionOrder(orderId) { alert(`Editing production order: ${orderId}`); }
        function trackDelivery(deliveryId) { alert(`Tracking delivery: ${deliveryId}`); }
        function updateDelivery(deliveryId) { alert(`Updating delivery: ${deliveryId}`); }

        function generateReport(reportType) {
            alert(`Generating ${reportType} report...`);
        }

        // Authentication System
        let currentUser = null;
        let isLoggedIn = false;

        // Demo users database
        const users = [
            { username: 'admin', password: 'password123', role: 'Administrator', name: 'System Administrator' },
            { username: 'manager', password: 'manager123', role: 'Manager', name: 'Production Manager' },
            { username: 'staff', password: 'staff123', role: 'Staff', name: 'Staff Member' },
            { username: 'demo', password: 'demo123', role: 'Demo User', name: 'Demo User' }
        ];

        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Clear previous messages
            hideMessage('errorMessage');
            hideMessage('successMessage');
            
            // Find user
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                isLoggedIn = true;
                
                showMessage('successMessage', `Welcome back, ${user.name}!`);
                
                // Save login status
                saveLoginStatus();
                
                // Delay before showing main app for better UX
                setTimeout(() => {
                    showMainApp();
                }, 1000);
            } else {
                showMessage('errorMessage', 'Invalid username or password. Please try again.');
                // Clear password field
                document.getElementById('password').value = '';
            }
        }

        function showMessage(messageId, text) {
            const messageElement = document.getElementById(messageId);
            messageElement.textContent = text;
            messageElement.classList.remove('hidden');
        }

        function hideMessage(messageId) {
            document.getElementById(messageId).classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').classList.add('show');
            
            // Update sidebar header with user info
            const sidebarHeader = document.querySelector('.sidebar-header');
            const userInfo = document.createElement('p');
            userInfo.style.marginTop = '5px';
            userInfo.style.fontSize = '0.8rem';
            userInfo.style.opacity = '0.9';
            userInfo.innerHTML = `Welcome, <strong>${currentUser.name}</strong><br><small>${currentUser.role}</small>`;
            sidebarHeader.appendChild(userInfo);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                isLoggedIn = false;
                currentUser = null;
                
                // Clear saved login status
                localStorage.removeItem('currentUser');
                
                // Hide main app and show login
                document.getElementById('mainApp').classList.remove('show');
                document.getElementById('loginScreen').style.display = 'flex';
                
                // Clear form
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                // Clear messages
                hideMessage('errorMessage');
                hideMessage('successMessage');
                
                // Remove user info from sidebar
                const userInfo = document.querySelector('.sidebar-header p:last-child');
                if (userInfo && userInfo.innerHTML.includes('Welcome')) {
                    userInfo.remove();
                }
            }
        }

        function showForgotPassword() {
            alert('Please contact your system administrator to reset your password.\n\nDemo credentials:\nUsername: admin\nPassword: password123');
        }

        // Check if user is already logged in (for demo purposes)
        function checkLoginStatus() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                isLoggedIn = true;
                showMainApp();
            }
        }

        // Save login status
        function saveLoginStatus() {
            if (currentUser) {
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            // No need to load all tables, dashboard is shown by default
        });

        // Close modals when clicking outside or ESC key
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.classList.add('hidden');
            }
        });

        // Close modal with ESC key
        window.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const openModals = document.querySelectorAll('.modal-overlay:not(.hidden)');
                openModals.forEach(modal => modal.classList.add('hidden'));
            }
        });

        // Prevent modal from closing when clicking inside modal content
        document.querySelectorAll('.modal-content').forEach(modalContent => {
            modalContent.addEventListener('click', function(event) {
                event.stopPropagation();
            });
        });
    </script>
</body>
</html>